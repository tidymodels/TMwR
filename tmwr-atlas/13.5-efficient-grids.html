<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="13.5 Tools for Efficient Grid Search | Tidy Modeling with R" />
<meta property="og:type" content="book" />
<meta property="og:image" content="/images/cover.png" />
<meta property="og:description" content="The tidymodels framework is a collection of R packages for modeling and machine learning using tidyverse principles. This book provides a thorough introduction to how to use tidymodels, and an outline of good methodology and statistical practice for phases of the modeling process." />
<meta name="github-repo" content="tidymodels/TMwR" />

<meta name="author" content="Max Kuhn and Julia Silge" />


<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<meta name="description" content="The tidymodels framework is a collection of R packages for modeling and machine learning using tidyverse principles. This book provides a thorough introduction to how to use tidymodels, and an outline of good methodology and statistical practice for phases of the modeling process.">

<title>13.5 Tools for Efficient Grid Search | Tidy Modeling with R</title>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="libs/navigation-1.1/tabsets.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
/* show arrow before summary tag as in bootstrap
TODO: remove if boostrap in updated in html_document (rmarkdown#1485) */
details > summary {
  display: list-item;
  cursor: pointer;
}
</style>
</head>

<body>

<div class="container-fluid main-container">


<div class="row">
<div class="col-sm-12">
<div id="TOC">
<ul>
<li class="has-sub"><a href="index.html#hello-world">Hello World</a>
<ul>
<li><a href="acknowledgments.html#acknowledgments">Acknowledgments</a></li>
<li><a href="using-code-examples.html#using-code-examples">Using Code Examples</a></li>
</ul></li>
<li class="part"><span><b>Introduction</b></span></li>
<li class="has-sub"><a href="1-software-modeling.html#software-modeling"><span class="toc-section-number">1</span> Software for modeling</a>
<ul>
<li><a href="1.1-fundamentals-for-modeling-software.html#fundamentals-for-modeling-software"><span class="toc-section-number">1.1</span> Fundamentals for Modeling Software</a></li>
<li class="has-sub"><a href="1.2-model-types.html#model-types"><span class="toc-section-number">1.2</span> Types of Models</a>
<ul>
<li><a href="1.2-model-types.html#descriptive-models">Descriptive models</a></li>
<li><a href="1.2-model-types.html#inferential-models">Inferential models</a></li>
<li><a href="1.2-model-types.html#predictive-models">Predictive models</a></li>
</ul></li>
<li><a href="1.3-connections-between-types-of-models.html#connections-between-types-of-models"><span class="toc-section-number">1.3</span> Connections Between Types of Models</a></li>
<li><a href="1.4-model-terminology.html#model-terminology"><span class="toc-section-number">1.4</span> Some Terminology</a></li>
<li><a href="1.5-model-phases.html#model-phases"><span class="toc-section-number">1.5</span> How Does Modeling Fit into the Data Analysis Process?</a></li>
<li><a href="1.6-software-summary.html#software-summary"><span class="toc-section-number">1.6</span> Chapter Summary</a></li>
</ul></li>
<li class="has-sub"><a href="2-tidyverse.html#tidyverse"><span class="toc-section-number">2</span> A Tidyverse Primer</a>
<ul>
<li class="has-sub"><a href="2.1-tidyverse-principles.html#tidyverse-principles"><span class="toc-section-number">2.1</span> Tidyverse Principles</a>
<ul>
<li><a href="2.1-tidyverse-principles.html#design-for-humans"><span class="toc-section-number">2.1.1</span> Design for humans</a></li>
<li><a href="2.1-tidyverse-principles.html#reuse-existing-data-structures"><span class="toc-section-number">2.1.2</span> Reuse existing data structures</a></li>
<li><a href="2.1-tidyverse-principles.html#design-for-the-pipe-and-functional-programming"><span class="toc-section-number">2.1.3</span> Design for the pipe and functional programming</a></li>
</ul></li>
<li><a href="2.2-examples-of-tidyverse-syntax.html#examples-of-tidyverse-syntax"><span class="toc-section-number">2.2</span> Examples of Tidyverse Syntax</a></li>
<li><a href="2.3-chapter-summary.html#chapter-summary"><span class="toc-section-number">2.3</span> Chapter Summary</a></li>
</ul></li>
<li class="has-sub"><a href="3-base-r.html#base-r"><span class="toc-section-number">3</span> A Review of R Modeling Fundamentals</a>
<ul>
<li><a href="3.1-an-example.html#an-example"><span class="toc-section-number">3.1</span> An Example</a></li>
<li><a href="3.2-formula.html#formula"><span class="toc-section-number">3.2</span> What Does the R Formula Do?</a></li>
<li><a href="3.3-tidiness-modeling.html#tidiness-modeling"><span class="toc-section-number">3.3</span> Why Tidiness is Important for Modeling</a></li>
<li><a href="3.4-combining-base-r-models-and-the-tidyverse.html#combining-base-r-models-and-the-tidyverse"><span class="toc-section-number">3.4</span> Combining Base R Models and the Tidyverse</a></li>
<li><a href="3.5-the-tidymodels-metapackage.html#the-tidymodels-metapackage"><span class="toc-section-number">3.5</span> The tidymodels Metapackage</a></li>
<li><a href="3.6-chapter-summary-1.html#chapter-summary-1"><span class="toc-section-number">3.6</span> Chapter Summary</a></li>
</ul></li>
<li class="part"><span><b>Modeling Basics</b></span></li>
<li class="has-sub"><a href="4-ames.html#ames"><span class="toc-section-number">4</span> The Ames Housing Data</a>
<ul>
<li><a href="4.1-exploring-features-of-homes-in-ames.html#exploring-features-of-homes-in-ames"><span class="toc-section-number">4.1</span> Exploring Features of Homes in Ames</a></li>
<li><a href="4.2-ames-summary.html#ames-summary"><span class="toc-section-number">4.2</span> Chapter Summary</a></li>
</ul></li>
<li class="has-sub"><a href="5-splitting.html#splitting"><span class="toc-section-number">5</span> Spending our Data</a>
<ul>
<li><a href="5.1-splitting-methods.html#splitting-methods"><span class="toc-section-number">5.1</span> Common Methods for Splitting Data</a></li>
<li><a href="5.2-what-about-a-validation-set.html#what-about-a-validation-set"><span class="toc-section-number">5.2</span> What About a Validation Set?</a></li>
<li><a href="5.3-multi-level-data.html#multi-level-data"><span class="toc-section-number">5.3</span> Multi-Level Data</a></li>
<li><a href="5.4-other-considerations-for-a-data-budget.html#other-considerations-for-a-data-budget"><span class="toc-section-number">5.4</span> Other Considerations for a Data Budget</a></li>
<li><a href="5.5-splitting-summary.html#splitting-summary"><span class="toc-section-number">5.5</span> Chapter Summary</a></li>
</ul></li>
<li class="has-sub"><a href="6-models.html#models"><span class="toc-section-number">6</span> Fitting Models with parsnip</a>
<ul>
<li><a href="6.1-create-a-model.html#create-a-model"><span class="toc-section-number">6.1</span> Create a Model</a></li>
<li><a href="6.2-use-the-model-results.html#use-the-model-results"><span class="toc-section-number">6.2</span> Use the Model Results</a></li>
<li><a href="6.3-parsnip-predictions.html#parsnip-predictions"><span class="toc-section-number">6.3</span> Make Predictions</a></li>
<li><a href="6.4-parsnip-extension-packages.html#parsnip-extension-packages"><span class="toc-section-number">6.4</span> parsnip-Extension Packages</a></li>
<li><a href="6.5-parsnip-addin.html#parsnip-addin"><span class="toc-section-number">6.5</span> Creating Model Specifications</a></li>
<li><a href="6.6-models-summary.html#models-summary"><span class="toc-section-number">6.6</span> Chapter Summary</a></li>
</ul></li>
<li class="has-sub"><a href="7-workflows.html#workflows"><span class="toc-section-number">7</span> A Model Workflow</a>
<ul>
<li><a href="7.1-begin-model-end.html#begin-model-end"><span class="toc-section-number">7.1</span> Where Does the Model Begin and End?</a></li>
<li><a href="7.2-workflow-basics.html#workflow-basics"><span class="toc-section-number">7.2</span> Workflow Basics</a></li>
<li><a href="7.3-adding-raw-variables-to-the-workflow.html#adding-raw-variables-to-the-workflow"><span class="toc-section-number">7.3</span> Adding Raw Variables to the <code>workflow()</code></a></li>
<li class="has-sub"><a href="7.4-workflow-encoding.html#workflow-encoding"><span class="toc-section-number">7.4</span> How Does a <code>workflow()</code> Use the Formula?</a>
<ul>
<li><a href="7.4-workflow-encoding.html#tree-based-models">Tree-based models</a></li>
<li><a href="7.4-workflow-encoding.html#special-model-formulas"><span class="toc-section-number">7.4.1</span> Special formulas and in-line functions</a></li>
</ul></li>
<li><a href="7.5-workflow-sets-intro.html#workflow-sets-intro"><span class="toc-section-number">7.5</span> Creating Multiple Workflows at Once</a></li>
<li><a href="7.6-evaluating-the-test-set.html#evaluating-the-test-set"><span class="toc-section-number">7.6</span> Evaluating the Test Set</a></li>
<li><a href="7.7-workflows-summary.html#workflows-summary"><span class="toc-section-number">7.7</span> Chapter Summary</a></li>
</ul></li>
<li class="has-sub"><a href="8-recipes.html#recipes"><span class="toc-section-number">8</span> Feature Engineering with recipes</a>
<ul>
<li><a href="8.1-a-simple-recipe-for-the-ames-housing-data.html#a-simple-recipe-for-the-ames-housing-data"><span class="toc-section-number">8.1</span> A Simple <code>recipe()</code> for the Ames Housing Data</a></li>
<li><a href="8.2-using-recipes.html#using-recipes"><span class="toc-section-number">8.2</span> Using Recipes</a></li>
<li><a href="8.3-how-data-are-used-by-the-recipe.html#how-data-are-used-by-the-recipe"><span class="toc-section-number">8.3</span> How Data are Used by the <code>recipe()</code></a></li>
<li class="has-sub"><a href="8.4-example-steps.html#example-steps"><span class="toc-section-number">8.4</span> Examples of <code>recipe()</code> Steps</a>
<ul>
<li><a href="8.4-example-steps.html#dummies"><span class="toc-section-number">8.4.1</span> Encoding qualitative data in a numeric format</a></li>
<li><a href="8.4-example-steps.html#interaction-terms"><span class="toc-section-number">8.4.2</span> Interaction terms</a></li>
<li><a href="8.4-example-steps.html#spline-functions"><span class="toc-section-number">8.4.3</span> Spline functions</a></li>
<li><a href="8.4-example-steps.html#feature-extraction"><span class="toc-section-number">8.4.4</span> Feature extraction</a></li>
<li><a href="8.4-example-steps.html#row-sampling-steps"><span class="toc-section-number">8.4.5</span> Row sampling steps</a></li>
<li><a href="8.4-example-steps.html#general-transformations"><span class="toc-section-number">8.4.6</span> General transformations</a></li>
<li><a href="8.4-example-steps.html#natural-language-processing"><span class="toc-section-number">8.4.7</span> Natural language processing</a></li>
</ul></li>
<li><a href="8.5-skip-equals-true.html#skip-equals-true"><span class="toc-section-number">8.5</span> Skipping Steps for New Data</a></li>
<li><a href="8.6-tidy-a-recipe.html#tidy-a-recipe"><span class="toc-section-number">8.6</span> Tidy a <code>recipe()</code></a></li>
<li><a href="8.7-column-roles.html#column-roles"><span class="toc-section-number">8.7</span> Column Roles</a></li>
<li><a href="8.8-recipes-summary.html#recipes-summary"><span class="toc-section-number">8.8</span> Chapter Summary</a></li>
</ul></li>
<li class="has-sub"><a href="9-performance.html#performance"><span class="toc-section-number">9</span> Judging Model Effectiveness</a>
<ul>
<li><a href="9.1-performance-metrics-and-inference.html#performance-metrics-and-inference"><span class="toc-section-number">9.1</span> Performance Metrics and Inference</a></li>
<li><a href="9.2-regression-metrics.html#regression-metrics"><span class="toc-section-number">9.2</span> Regression Metrics</a></li>
<li><a href="9.3-binary-classification-metrics.html#binary-classification-metrics"><span class="toc-section-number">9.3</span> Binary Classification Metrics</a></li>
<li><a href="9.4-multi-class-classification-metrics.html#multi-class-classification-metrics"><span class="toc-section-number">9.4</span> Multi-Class Classification Metrics</a></li>
<li><a href="9.5-performance-summary.html#performance-summary"><span class="toc-section-number">9.5</span> Chapter Summary</a></li>
</ul></li>
<li class="part"><span><b>Tools for Creating Effective Models</b></span></li>
<li class="has-sub"><a href="10-resampling.html#resampling"><span class="toc-section-number">10</span> Resampling for Evaluating Performance</a>
<ul>
<li><a href="10.1-resampling-resubstition.html#resampling-resubstition"><span class="toc-section-number">10.1</span> The Resubstitution Approach</a></li>
<li class="has-sub"><a href="10.2-resampling-methods.html#resampling-methods"><span class="toc-section-number">10.2</span> Resampling Methods</a>
<ul>
<li><a href="10.2-resampling-methods.html#cv"><span class="toc-section-number">10.2.1</span> Cross-validation</a></li>
<li><a href="10.2-resampling-methods.html#repeated-cross-validation">Repeated cross-validation</a></li>
<li><a href="10.2-resampling-methods.html#leave-one-out-cross-validation">Leave-one-out cross-validation</a></li>
<li><a href="10.2-resampling-methods.html#monte-carlo-cross-validation">Monte Carlo cross-validation</a></li>
<li><a href="10.2-resampling-methods.html#validation"><span class="toc-section-number">10.2.2</span> Validation sets</a></li>
<li><a href="10.2-resampling-methods.html#bootstrap"><span class="toc-section-number">10.2.3</span> Bootstrapping</a></li>
<li><a href="10.2-resampling-methods.html#rolling"><span class="toc-section-number">10.2.4</span> Rolling forecasting origin resampling</a></li>
</ul></li>
<li><a href="10.3-resampling-performance.html#resampling-performance"><span class="toc-section-number">10.3</span> Estimating Performance</a></li>
<li><a href="10.4-parallel.html#parallel"><span class="toc-section-number">10.4</span> Parallel Processing</a></li>
<li><a href="10.5-extract.html#extract"><span class="toc-section-number">10.5</span> Saving the Resampled Objects</a></li>
<li><a href="10.6-resampling-summary.html#resampling-summary"><span class="toc-section-number">10.6</span> Chapter Summary</a></li>
</ul></li>
<li class="has-sub"><a href="11-compare.html#compare"><span class="toc-section-number">11</span> Comparing Models with Resampling</a>
<ul>
<li><a href="11.1-workflow-set.html#workflow-set"><span class="toc-section-number">11.1</span> Creating Multiple Models with Workflow Sets</a></li>
<li><a href="11.2-resampled-stats.html#resampled-stats"><span class="toc-section-number">11.2</span> Comparing Resampled Performance Statistics</a></li>
<li><a href="11.3-simple-hypothesis-testing-methods.html#simple-hypothesis-testing-methods"><span class="toc-section-number">11.3</span> Simple Hypothesis Testing Methods</a></li>
<li class="has-sub"><a href="11.4-tidyposterior.html#tidyposterior"><span class="toc-section-number">11.4</span> Bayesian Methods</a>
<ul>
<li><a href="11.4-tidyposterior.html#the-effect-of-the-amount-of-resampling">The effect of the amount of resampling</a></li>
</ul></li>
<li><a href="11.5-compare-summary.html#compare-summary"><span class="toc-section-number">11.5</span> Chapter Summary</a></li>
</ul></li>
<li class="has-sub"><a href="12-tuning.html#tuning"><span class="toc-section-number">12</span> Model Tuning and the Dangers of Overfitting</a>
<ul>
<li><a href="12.1-model-parameters.html#model-parameters"><span class="toc-section-number">12.1</span> Model Parameters</a></li>
<li><a href="12.2-tuning-parameter-examples.html#tuning-parameter-examples"><span class="toc-section-number">12.2</span> Tuning Parameters for Different Types of Models</a></li>
<li><a href="12.3-what-to-optimize.html#what-to-optimize"><span class="toc-section-number">12.3</span> What do we Optimize?</a></li>
<li><a href="12.4-overfitting-bad.html#overfitting-bad"><span class="toc-section-number">12.4</span> The consequences of poor parameter estimates</a></li>
<li><a href="12.5-two-general-strategies-for-optimization.html#two-general-strategies-for-optimization"><span class="toc-section-number">12.5</span> Two general strategies for optimization</a></li>
<li><a href="12.6-tuning-params-tidymodels.html#tuning-params-tidymodels"><span class="toc-section-number">12.6</span> Tuning Parameters in tidymodels</a></li>
<li><a href="12.7-chapter-summary-2.html#chapter-summary-2"><span class="toc-section-number">12.7</span> Chapter Summary</a></li>
</ul></li>
<li class="has-sub"><a href="13-grid-search.html#grid-search"><span class="toc-section-number">13</span> Grid Search</a>
<ul>
<li class="has-sub"><a href="13.1-grids.html#grids"><span class="toc-section-number">13.1</span> Regular and Non-Regular Grids</a>
<ul>
<li><a href="13.1-grids.html#regular-grids">Regular grids</a></li>
<li><a href="13.1-grids.html#irregular-grids">Irregular grids</a></li>
</ul></li>
<li><a href="13.2-evaluating-grid.html#evaluating-grid"><span class="toc-section-number">13.2</span> Evaluating the Grid</a></li>
<li><a href="13.3-finalizing-the-model.html#finalizing-the-model"><span class="toc-section-number">13.3</span> Finalizing the Model</a></li>
<li><a href="13.4-tuning-usemodels.html#tuning-usemodels"><span class="toc-section-number">13.4</span> Tools for Creating Tuning Specifications</a></li>
<li class="has-sub"><a href="13.5-efficient-grids.html#efficient-grids"><span class="toc-section-number">13.5</span> Tools for Efficient Grid Search</a>
<ul>
<li><a href="13.5-efficient-grids.html#submodel-trick"><span class="toc-section-number">13.5.1</span> Submodel optimization</a></li>
<li><a href="13.5-efficient-grids.html#parallel-processing"><span class="toc-section-number">13.5.2</span> Parallel processing</a></li>
<li><a href="13.5-efficient-grids.html#benchmarking-boosted-trees"><span class="toc-section-number">13.5.3</span> Benchmarking boosted trees</a></li>
<li><a href="13.5-efficient-grids.html#access-to-global-variables"><span class="toc-section-number">13.5.4</span> Access to global variables</a></li>
<li><a href="13.5-efficient-grids.html#racing"><span class="toc-section-number">13.5.5</span> Racing methods</a></li>
</ul></li>
<li><a href="13.6-grid-summary.html#grid-summary"><span class="toc-section-number">13.6</span> Chapter Summary</a></li>
</ul></li>
<li class="has-sub"><a href="14-iterative-search.html#iterative-search"><span class="toc-section-number">14</span> Iterative Search</a>
<ul>
<li><a href="14.1-svm.html#svm"><span class="toc-section-number">14.1</span> A Support Vector Machine Model</a></li>
<li class="has-sub"><a href="14.2-bayesian-optimization.html#bayesian-optimization"><span class="toc-section-number">14.2</span> Bayesian Optimization</a>
<ul>
<li><a href="14.2-bayesian-optimization.html#a-gaussian-process-model"><span class="toc-section-number">14.2.1</span> A Gaussian process model</a></li>
<li><a href="14.2-bayesian-optimization.html#acquisition-functions"><span class="toc-section-number">14.2.2</span> Acquisition functions</a></li>
<li><a href="14.2-bayesian-optimization.html#tune-bayes"><span class="toc-section-number">14.2.3</span> The <code>tune_bayes()</code> function</a></li>
</ul></li>
<li class="has-sub"><a href="14.3-simulated-annealing.html#simulated-annealing"><span class="toc-section-number">14.3</span> Simulated Annealing</a>
<ul>
<li><a href="14.3-simulated-annealing.html#simulated-annealing-search-process"><span class="toc-section-number">14.3.1</span> Simulated annealing search process</a></li>
<li><a href="14.3-simulated-annealing.html#tune-sim-anneal"><span class="toc-section-number">14.3.2</span> The <code>tune_sim_anneal()</code> function</a></li>
</ul></li>
<li><a href="14.4-iterative-summary.html#iterative-summary"><span class="toc-section-number">14.4</span> Chapter Summary</a></li>
</ul></li>
<li class="has-sub"><a href="15-workflow-sets.html#workflow-sets"><span class="toc-section-number">15</span> Screening Many Models</a>
<ul>
<li><a href="15.1-modeling-concrete-mixture-strength.html#modeling-concrete-mixture-strength"><span class="toc-section-number">15.1</span> Modeling Concrete Mixture Strength</a></li>
<li><a href="15.2-creating-the-workflow-set.html#creating-the-workflow-set"><span class="toc-section-number">15.2</span> Creating the Workflow Set</a></li>
<li><a href="15.3-tuning-and-evaluating-the-models.html#tuning-and-evaluating-the-models"><span class="toc-section-number">15.3</span> Tuning and Evaluating the Models</a></li>
<li><a href="15.4-racing-example.html#racing-example"><span class="toc-section-number">15.4</span> Efficiently Screening Models</a></li>
<li><a href="15.5-finalizing-a-model.html#finalizing-a-model"><span class="toc-section-number">15.5</span> Finalizing a Model</a></li>
<li><a href="15.6-workflow-sets-summary.html#workflow-sets-summary"><span class="toc-section-number">15.6</span> Chapter Summary</a></li>
</ul></li>
<li class="part"><span><b>Beyond the Basics</b></span></li>
<li class="has-sub"><a href="16-dimensionality.html#dimensionality"><span class="toc-section-number">16</span> Dimensionality Reduction</a>
<ul>
<li><a href="16.1-when-problems-can-dimensionality-reduction-solve.html#when-problems-can-dimensionality-reduction-solve"><span class="toc-section-number">16.1</span> When Problems Can Dimensionality Reduction Solve?</a></li>
<li><a href="16.2-beans.html#beans"><span class="toc-section-number">16.2</span> A Picture is Worth a Thousand… Beans</a></li>
<li><a href="16.3-a-starter-recipe.html#a-starter-recipe"><span class="toc-section-number">16.3</span> A Starter Recipe</a></li>
<li class="has-sub"><a href="16.4-recipe-functions.html#recipe-functions"><span class="toc-section-number">16.4</span> Recipes in the Wild</a>
<ul>
<li><a href="16.4-recipe-functions.html#prep"><span class="toc-section-number">16.4.1</span> Preparing a recipe</a></li>
<li><a href="16.4-recipe-functions.html#bake"><span class="toc-section-number">16.4.2</span> Baking the recipe</a></li>
</ul></li>
<li class="has-sub"><a href="16.5-feature-extraction-techniques.html#feature-extraction-techniques"><span class="toc-section-number">16.5</span> Feature Extraction Techniques</a>
<ul>
<li><a href="16.5-feature-extraction-techniques.html#principal-component-analysis"><span class="toc-section-number">16.5.1</span> Principal component analysis</a></li>
<li><a href="16.5-feature-extraction-techniques.html#partial-least-squares"><span class="toc-section-number">16.5.2</span> Partial least squares</a></li>
<li><a href="16.5-feature-extraction-techniques.html#independent-component-analysis"><span class="toc-section-number">16.5.3</span> Independent component analysis</a></li>
<li><a href="16.5-feature-extraction-techniques.html#uniform-manifold-approximation-and-projection"><span class="toc-section-number">16.5.4</span> Uniform manifold approximation and projection</a></li>
</ul></li>
<li><a href="16.6-bean-models.html#bean-models"><span class="toc-section-number">16.6</span> Modeling</a></li>
<li><a href="16.7-dimensionality-summary.html#dimensionality-summary"><span class="toc-section-number">16.7</span> Chapter Summary</a></li>
</ul></li>
<li class="has-sub"><a href="17-categorical.html#categorical"><span class="toc-section-number">17</span> Encoding Categorical Data</a>
<ul>
<li><a href="17.1-is-an-encoding-necessary.html#is-an-encoding-necessary"><span class="toc-section-number">17.1</span> Is an Encoding Necessary?</a></li>
<li><a href="17.2-encoding-ordinal-predictors.html#encoding-ordinal-predictors"><span class="toc-section-number">17.2</span> Encoding Ordinal Predictors</a></li>
<li class="has-sub"><a href="17.3-using-the-outcome-for-encoding-predictors.html#using-the-outcome-for-encoding-predictors"><span class="toc-section-number">17.3</span> Using the Outcome for Encoding Predictors</a>
<ul>
<li><a href="17.3-using-the-outcome-for-encoding-predictors.html#effect-encodings-with-partial-pooling"><span class="toc-section-number">17.3.1</span> Effect encodings with partial pooling</a></li>
</ul></li>
<li><a href="17.4-feature-hashing.html#feature-hashing"><span class="toc-section-number">17.4</span> Feature Hashing</a></li>
<li><a href="17.5-more-encoding-options.html#more-encoding-options"><span class="toc-section-number">17.5</span> More Encoding Options</a></li>
<li><a href="17.6-categorical-summary.html#categorical-summary"><span class="toc-section-number">17.6</span> Chapter Summary</a></li>
</ul></li>
<li class="has-sub"><a href="18-explain.html#explain"><span class="toc-section-number">18</span> Explaining Models and Predictions</a>
<ul>
<li><a href="18.1-software-for-model-explanations.html#software-for-model-explanations"><span class="toc-section-number">18.1</span> Software for Model Explanations</a></li>
<li><a href="18.2-local-explanations.html#local-explanations"><span class="toc-section-number">18.2</span> Local Explanations</a></li>
<li><a href="18.3-global-explanations.html#global-explanations"><span class="toc-section-number">18.3</span> Global Explanations</a></li>
<li><a href="18.4-building-global-explanations-from-local-explanations.html#building-global-explanations-from-local-explanations"><span class="toc-section-number">18.4</span> Building Global Explanations from Local Explanations</a></li>
<li><a href="18.5-back-to-beans.html#back-to-beans"><span class="toc-section-number">18.5</span> Back to Beans!</a></li>
<li><a href="18.6-explain-summary.html#explain-summary"><span class="toc-section-number">18.6</span> Chapter Summary</a></li>
</ul></li>
<li class="has-sub"><a href="19-trust.html#trust"><span class="toc-section-number">19</span> When Should You Trust Your Predictions?</a>
<ul>
<li><a href="19.1-equivocal-zones.html#equivocal-zones"><span class="toc-section-number">19.1</span> Equivocal Results</a></li>
<li><a href="19.2-applicability-domains.html#applicability-domains"><span class="toc-section-number">19.2</span> Determining Model Applicability</a></li>
<li><a href="19.3-trust-summary.html#trust-summary"><span class="toc-section-number">19.3</span> Chapter Summary</a></li>
</ul></li>
<li class="has-sub"><a href="20-ensembles.html#ensembles"><span class="toc-section-number">20</span> Ensembles of Models</a>
<ul>
<li><a href="20.1-data-stack.html#data-stack"><span class="toc-section-number">20.1</span> Creating the Training Set for Stacking</a></li>
<li><a href="20.2-blend-predictions.html#blend-predictions"><span class="toc-section-number">20.2</span> Blend the Predictions</a></li>
<li><a href="20.3-fit-members.html#fit-members"><span class="toc-section-number">20.3</span> Fit the Member Models</a></li>
<li><a href="20.4-test-set-results.html#test-set-results"><span class="toc-section-number">20.4</span> Test Set Results</a></li>
<li><a href="20.5-ensembles-summary.html#ensembles-summary"><span class="toc-section-number">20.5</span> Chapter Summary</a></li>
</ul></li>
<li class="has-sub"><a href="21-inferential.html#inferential"><span class="toc-section-number">21</span> Inferential Analysis</a>
<ul>
<li><a href="21.1-inference-for-count-data.html#inference-for-count-data"><span class="toc-section-number">21.1</span> Inference for Count Data</a></li>
<li><a href="21.2-comparisons-with-two-sample-tests.html#comparisons-with-two-sample-tests"><span class="toc-section-number">21.2</span> Comparisons with Two-Sample Tests</a></li>
<li><a href="21.3-log-linear-models.html#log-linear-models"><span class="toc-section-number">21.3</span> Log-Linear Models</a></li>
<li><a href="21.4-a-more-complex-model.html#a-more-complex-model"><span class="toc-section-number">21.4</span> A More Complex Model</a></li>
<li><a href="21.5-inference-options.html#inference-options"><span class="toc-section-number">21.5</span> More Inferential Analysis</a></li>
<li><a href="21.6-inference-summary.html#inference-summary"><span class="toc-section-number">21.6</span> Chapter Summary</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li><a href="A-pre-proc-table.html#pre-proc-table"><span class="toc-section-number">A</span> Recommended Preprocessing</a></li>
<li><a href="references.html#references">REFERENCES</a></li>
</ul>
</div>
</div>
</div>
<div class="row">
<div class="col-sm-12">
<div id="efficient-grids" class="section level2" number="13.5">
<h2><span class="header-section-number">13.5</span> Tools for Efficient Grid Search</h2>
<p>It is possible to make grid search more computationally efficient by applying a few different tricks and optimizations. This section describes several techniques.</p>
<div id="submodel-trick" class="section level3" number="13.5.1">
<h3><span class="header-section-number">13.5.1</span> Submodel optimization</h3>
<p>There are types of models where, from a single model fit, multiple tuning parameters can be evaluated without refitting.</p>
<p>For example, partial least squares (PLS) is a supervised version of principal component analysis <span class="citation">(<a href="#ref-Geladi:1986" role="doc-biblioref">Geladi and Kowalski 1986</a>)</span>. It creates components that maximize the variation in the predictors (like PCA) but simultaneously tries to maximize the correlation between these predictors and the outcome. We’ll explore PLS more in Chapter <a href="16-dimensionality.html#dimensionality">16</a>. One tuning parameter is the number of PLS components to retain. Suppose that a data set with 100 predictors is fit using PLS. The number of possible components to retain can range from one to fifty. However, in many implementations, a single model fit can compute predicted values across many values of <code>num_comp</code>. As a result, a PLS model created with 100 components can also make predictions for any <code>num_comp &lt;= 100</code>. This saves time since, instead of creating redundant model fits, a single fit can be used to evaluate many submodels.</p>
<p>While not all models can exploit this feature, many broadly used ones do:</p>
<ul>
<li><p>Boosting models can typically make predictions across multiple values for the number of boosting iterations.</p></li>
<li><p>Regularization methods, such as the <span class="pkg">glmnet</span> model, can make simultaneous predictions across the amount of regularization used to fit the model.</p></li>
<li><p>Multivariate adaptive regression splines (MARS) adds a set of nonlinear features to linear regression models <span class="citation">(<a href="#ref-Friedman:1991p109" role="doc-biblioref">Friedman 1991</a>)</span>. The number of terms to retain is a tuning parameter and it is computationally fast to make predictions across many values of this parameter from a single model fit.</p></li>
</ul>
<p>The <span class="pkg">tune</span> package automatically applies this type of optimization whenever an applicable model is tuned.</p>
<p>For example, if a boosted C5.0 classification model <span class="citation">(<a href="#ref-apm" role="doc-biblioref">M. Kuhn and Johnson 2013</a>)</span> was fit to the cell data, we can tune the number of boosting iterations (<code>trees</code>). With all other parameters set at their default values, we can evaluate iterations from 1 to 100 on the same resamples as used previously:</p>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb220-1"><a href="13.5-efficient-grids.html#cb220-1" aria-hidden="true" tabindex="-1"></a>c5_spec <span class="ot">&lt;-</span> </span>
<span id="cb220-2"><a href="13.5-efficient-grids.html#cb220-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">boost_tree</span>(<span class="at">trees =</span> <span class="fu">tune</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb220-3"><a href="13.5-efficient-grids.html#cb220-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">&quot;C5.0&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb220-4"><a href="13.5-efficient-grids.html#cb220-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">&quot;classification&quot;</span>)</span>
<span id="cb220-5"><a href="13.5-efficient-grids.html#cb220-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb220-6"><a href="13.5-efficient-grids.html#cb220-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1307</span>)</span>
<span id="cb220-7"><a href="13.5-efficient-grids.html#cb220-7" aria-hidden="true" tabindex="-1"></a>c5_spec <span class="sc">%&gt;%</span></span>
<span id="cb220-8"><a href="13.5-efficient-grids.html#cb220-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tune_grid</span>(</span>
<span id="cb220-9"><a href="13.5-efficient-grids.html#cb220-9" aria-hidden="true" tabindex="-1"></a>    class <span class="sc">~</span> .,</span>
<span id="cb220-10"><a href="13.5-efficient-grids.html#cb220-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">resamples =</span> cell_folds,</span>
<span id="cb220-11"><a href="13.5-efficient-grids.html#cb220-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">grid =</span> <span class="fu">data.frame</span>(<span class="at">trees =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>),</span>
<span id="cb220-12"><a href="13.5-efficient-grids.html#cb220-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">metrics =</span> roc_res</span>
<span id="cb220-13"><a href="13.5-efficient-grids.html#cb220-13" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<p>Without the submodel optimization, the call to <code>tune_grid()</code> used 62.2 minutes to resample 100 submodels. With the optimization, the same call took 100 <em>seconds</em> (a speedup of 37-fold). The reduced time is the difference in <code>tune_grid()</code> fitting 1000 models versus 10 models.</p>
<div class="rmdnote">
<p>Even though we fit the model with and without the submodel prediction trick, this optimization is automatically applied by <span class="pkg">parsnip</span>.</p>
</div>
</div>
<div id="parallel-processing" class="section level3" number="13.5.2">
<h3><span class="header-section-number">13.5.2</span> Parallel processing</h3>
<p>As previously mentioned in Chapter <a href="10-resampling.html#resampling">10</a>, parallel processing is an effective method for decreasing execution time when resampling models. This advantage conveys to model tuning via grid search, although there are additional considerations.</p>
<p>Let’s consider two different parallel processing schemes.</p>
<p>When tuning models via grid search, there are two distinct loops: one over resamples and another over the unique tuning parameter combinations. In pseudocode, this process would look like:</p>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb221-1"><a href="13.5-efficient-grids.html#cb221-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (rs <span class="cf">in</span> resamples) {</span>
<span id="cb221-2"><a href="13.5-efficient-grids.html#cb221-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create analysis and assessment sets</span></span>
<span id="cb221-3"><a href="13.5-efficient-grids.html#cb221-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Preprocess data (e.g. formula or recipe)</span></span>
<span id="cb221-4"><a href="13.5-efficient-grids.html#cb221-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (mod <span class="cf">in</span> configurations) {</span>
<span id="cb221-5"><a href="13.5-efficient-grids.html#cb221-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Fit model {mod} to the {rs} analysis set</span></span>
<span id="cb221-6"><a href="13.5-efficient-grids.html#cb221-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Predict the {rs} assessment set</span></span>
<span id="cb221-7"><a href="13.5-efficient-grids.html#cb221-7" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb221-8"><a href="13.5-efficient-grids.html#cb221-8" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>By default, the <span class="pkg">tune</span> package only parallelizes over resamples (the outer loop), as opposed to both the outer and inner loops.</p>
<p>This is the optimal scenario when the preprocessing method is expensive. However, there are two potential downsides to this approach:</p>
<ul>
<li><p>It limits the achievable speed-ups when the preprocessing is not expensive.</p></li>
<li><p>The number of parallel workers is limited by the number of resamples. For example, with 10-fold cross-validation you can only use 10 parallel workers even when the computer has more than 10 cores.</p></li>
</ul>
<p>To illustrate how the parallel processing works, we’ll use a case where there are 7 model tuning parameter values, with 5-fold cross-validation. Figure <a href="13.5-efficient-grids.html#fig:one-resample-per-worker">13.5</a> shows how the tasks are allocated to the worker processes.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:one-resample-per-worker"></span>
<img src="figures/one-resample-per-worker-1.png" alt="A diagram of the worker processes when parallel processing matches resamples to a specific worker process. After the preprocess operations are finished, each model fit is executed on the same worker process." width="50%" />
<p class="caption">
Figure 13.5: Worker processes when parallel processing matches resamples to a specific worker process.
</p>
</div>
<p>Note that each fold is assigned to its own worker process and, since only model parameters are being tuned, the preprocessing is conducted once per fold/worker. If fewer than 5 worker processes were used, some workers would receive multiple folds.</p>
<p>In the control functions for the <code>tune_*()</code> functions, the argument <code>parallel_over</code> controls how the process is executed. To use the previous parallelization strategy, the argument is <code>parallel_over = "resamples"</code>.</p>
<p>Instead of parallel processing the resamples, an alternate scheme combines the loops over resamples and models into a single loop. In pseudocode, this process would look like:</p>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb222-1"><a href="13.5-efficient-grids.html#cb222-1" aria-hidden="true" tabindex="-1"></a>all_tasks <span class="ot">&lt;-</span> <span class="fu">crossing</span>(resamples, configurations)</span>
<span id="cb222-2"><a href="13.5-efficient-grids.html#cb222-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb222-3"><a href="13.5-efficient-grids.html#cb222-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (iter <span class="cf">in</span> all_tasks) {                           </span>
<span id="cb222-4"><a href="13.5-efficient-grids.html#cb222-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create analysis and assessment sets for {iter}</span></span>
<span id="cb222-5"><a href="13.5-efficient-grids.html#cb222-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Preprocess data (e.g. formula or recipe)</span></span>
<span id="cb222-6"><a href="13.5-efficient-grids.html#cb222-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Fit model {iter} to the {iter} analysis set</span></span>
<span id="cb222-7"><a href="13.5-efficient-grids.html#cb222-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Predict the {iter} assessment set</span></span>
<span id="cb222-8"><a href="13.5-efficient-grids.html#cb222-8" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>In this case, parallelization now occurs over the single loop. For example, if we use 5-fold cross-validation with <span class="math inline">\(M\)</span> tuning parameter values, the loop is executed over <span class="math inline">\(5\times M\)</span> iterations. This increases the number of potential workers that can be used. However, the work related to data preprocessing is repeated multiple times. If those steps are expensive, this approach will be inefficient.</p>
<p>In tidymodels, validation sets are treated as a single resample. In these cases, this parallelization scheme would be best.</p>
<p>Figure <a href="13.5-efficient-grids.html#fig:distributed-tasks">13.6</a> illustrates the delegation of tasks to the workers in this scheme, the same example is used but with 10 workers.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:distributed-tasks"></span>
<img src="figures/distributed-tasks-1.png" alt="A diagram of the worker processes when preprocessing and modeling tasks are distributed to many workers. In this instance, more comprehensive parallelization is used but some preprocessing tasks are repeated across worker processes." width="70%" />
<p class="caption">
Figure 13.6: Worker processes when preprocessing and modeling tasks are distributed to many workers.
</p>
</div>
<p>Here, each worker process handles multiple folds and the preprocessing is needlessly repeated. For example, for the first fold, the preprocessing was computed 7 times instead of once.</p>
<p>For this scheme, the control function argument is <code>parallel_over = "everything"</code>.</p>
</div>
<div id="benchmarking-boosted-trees" class="section level3" number="13.5.3">
<h3><span class="header-section-number">13.5.3</span> Benchmarking boosted trees</h3>
<p>To compare different possible parallelization schemes, we tuned a boosted tree with the <span class="pkg">xgboost</span> engine using a data set of 4,000 samples, with 5-fold cross-validation and 10 candidate models. These data required some baseline preprocessing that did not require any estimation. The preprocessing was handled three different ways:</p>
<ol style="list-style-type: decimal">
<li>Preprocess the data prior to modeling using a <span class="pkg">dplyr</span> pipeline (labeled as “none” in the later plots).</li>
<li>Conduct the same preprocessing via a recipe (shown as “light” preprocessing).</li>
<li>With a recipe, add an additional step that has a high computational cost (labeled as “expensive”).</li>
</ol>
<p>The first and second preprocessing options are designed for comparison, to measure the computational cost of the recipe in the second option. The third option measures the cost of performing redundant computations with <code>parallel_over = "everything"</code>.</p>
<p>We evaluated this process using variable numbers of worker processes and using the two <code>parallel_over</code> options, on a computer with 10 physical cores and 20 virtual cores (via hyper-threading).</p>
<p>First, let’s consider the raw execution times in Figure <a href="13.5-efficient-grids.html#fig:parallel-times">13.7</a>.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:parallel-times"></span>
<img src="figures/parallel-times-1.png" alt="Execution times for model tuning versus the number of workers using different delegation schemes. The diagonal black line indicates a linear speedup where the addition of a new worker process has maximal effect. The 'everything' scheme shows that the benefits decrease after three or four workers, especially when there is expensive preprocessing. The 'resamples' scheme has almost linear speedups across all tasks." width="70%" />
<p class="caption">
Figure 13.7: Execution times for model tuning versus the number of workers using different delegation schemes. The diagonal black line indicates a linear speedup where the addition of a new worker process has maximal effect.
</p>
</div>
<p>Since there were only five resamples, the number of cores used when <code>parallel_over = "resamples"</code> is limited to five.</p>
<p>Comparing the curves in the first two panels for “none” and “light”:</p>
<ul>
<li><p>There is little difference in the execution times between the panels. This indicates, for these data, there is no real computational penalty for doing the preprocessing steps in a recipe.</p></li>
<li><p>There is some benefit for using <code>parallel_over = "everything"</code> with many cores. However, as shown in the figure, the majority of the benefit of parallel processing occurs in the first five workers.</p></li>
</ul>
<p>With the expensive preprocessing step, there is a considerable difference in execution times. Using <code>parallel_over = "everything"</code> is problematic since, even using all cores, it never achieves the execution time that <code>parallel_over = "resamples"</code> attains with just five cores. This is because the costly preprocessing step is unnecessarily repeated in the computational scheme.</p>
<p>We can also view these data in terms of speed-ups in Figure <a href="13.5-efficient-grids.html#fig:parallel-speedups">13.8</a>.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:parallel-speedups"></span>
<img src="figures/parallel-speedups-1.png" alt="Speed-ups for model tuning versus the number of workers using different delegation schemes." width="70%" />
<p class="caption">
Figure 13.8: Speed-ups for model tuning versus the number of workers using different delegation schemes.
</p>
</div>
<p>The best speed-ups, for these data, occur when <code>parallel_over = "resamples"</code> and when the computations are expensive. However, in the latter case, remember that the previous analysis indicates that the overall model fits are slower.</p>
<p>What is the benefit of using the submodel optimization method in conjunction with parallel processing? The C5.0 classification model shown in Chapter <a href="13-grid-search.html#grid-search">13</a> was also run in parallel with ten workers. The parallel computations took 13.3 seconds for a speed-up of 7.5-fold (both runs used the submodel optimization trick). Between the submodel optimization trick and parallel processing, there was a total speed-up of 282-fold over the most basic grid search code.</p>
<div class="rmdwarning">
<p>Overall, note that the increased computational savings will vary from model-to-model and are also affected by the size of the grid, the number of resamples, etc. A very computationally efficient model may not benefit as much from parallel processing.</p>
</div>
</div>
<div id="access-to-global-variables" class="section level3" number="13.5.4">
<h3><span class="header-section-number">13.5.4</span> Access to global variables</h3>
<p>When using tidymodels, it is possible to use values in your local environment (usually the global environment) in model objects.</p>
<div class="rmdnote">
<p>What do we mean by “environment” here? Think of an environment in R as a place to store variables that you can work with. See the “Environments” chapter of <span class="citation">Wickham (<a href="#ref-wickham2019advanced" role="doc-biblioref">2019</a>)</span> to learn more.</p>
</div>
<p>If we define a variable to use as a model parameter and then pass it to a function like <code>linear_reg()</code>, the variable is typically defined in the global environment.</p>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="13.5-efficient-grids.html#cb223-1" aria-hidden="true" tabindex="-1"></a>coef_penalty <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb223-2"><a href="13.5-efficient-grids.html#cb223-2" aria-hidden="true" tabindex="-1"></a>spec <span class="ot">&lt;-</span> <span class="fu">linear_reg</span>(<span class="at">penalty =</span> coef_penalty) <span class="sc">%&gt;%</span> <span class="fu">set_engine</span>(<span class="st">&quot;glmnet&quot;</span>)</span>
<span id="cb223-3"><a href="13.5-efficient-grids.html#cb223-3" aria-hidden="true" tabindex="-1"></a>spec</span>
<span id="cb223-4"><a href="13.5-efficient-grids.html#cb223-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Linear Regression Model Specification (regression)</span></span>
<span id="cb223-5"><a href="13.5-efficient-grids.html#cb223-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb223-6"><a href="13.5-efficient-grids.html#cb223-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Main Arguments:</span></span>
<span id="cb223-7"><a href="13.5-efficient-grids.html#cb223-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   penalty = coef_penalty</span></span>
<span id="cb223-8"><a href="13.5-efficient-grids.html#cb223-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb223-9"><a href="13.5-efficient-grids.html#cb223-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Computational engine: glmnet</span></span></code></pre></div>
<p>Models created with the parsnip package save arguments like these as <em>quosures</em>; these are objects that track both the name of the object as well as the environment where it lives:</p>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb224-1"><a href="13.5-efficient-grids.html#cb224-1" aria-hidden="true" tabindex="-1"></a>spec<span class="sc">$</span>args<span class="sc">$</span>penalty</span>
<span id="cb224-2"><a href="13.5-efficient-grids.html#cb224-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &lt;quosure&gt;</span></span>
<span id="cb224-3"><a href="13.5-efficient-grids.html#cb224-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; expr: ^coef_penalty</span></span>
<span id="cb224-4"><a href="13.5-efficient-grids.html#cb224-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; env:  global</span></span></code></pre></div>
<p>Notice that we have <code>env:  global</code> because this variable was created in the global environment. The model specification defined by <code>spec</code> works correctly when run in a user’s regular session because that session is also using the global environment; R can easily find the object <code>coef_penalty</code>.</p>
<div class="rmdwarning">
<p>When such a model is evaluated with parallel workers, it may fail. Depending on the particular technology that is used for parallel processing, the workers may not have access to the global environment.</p>
</div>
<p>When writing code that will be run in parallel, it is a good idea to insert the actual data into the objects rather than the reference to the object. The <span class="pkg">rlang</span> and <span class="pkg">dplyr</span> packages can be very helpful for this. For example, the <code>!!</code> operator can splice a single value into an object:</p>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb225-1"><a href="13.5-efficient-grids.html#cb225-1" aria-hidden="true" tabindex="-1"></a>spec <span class="ot">&lt;-</span> <span class="fu">linear_reg</span>(<span class="at">penalty =</span> <span class="sc">!!</span>coef_penalty) <span class="sc">%&gt;%</span> <span class="fu">set_engine</span>(<span class="st">&quot;glmnet&quot;</span>)</span>
<span id="cb225-2"><a href="13.5-efficient-grids.html#cb225-2" aria-hidden="true" tabindex="-1"></a>spec<span class="sc">$</span>args<span class="sc">$</span>penalty</span>
<span id="cb225-3"><a href="13.5-efficient-grids.html#cb225-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &lt;quosure&gt;</span></span>
<span id="cb225-4"><a href="13.5-efficient-grids.html#cb225-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; expr: ^0.1</span></span>
<span id="cb225-5"><a href="13.5-efficient-grids.html#cb225-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; env:  empty</span></span></code></pre></div>
<p>Now the output is <code>^0.1</code>, indicating that the value is there instead of the reference to the object. When you have multiple external values to insert into an object, the <code>!!!</code> operator can help:</p>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb226-1"><a href="13.5-efficient-grids.html#cb226-1" aria-hidden="true" tabindex="-1"></a>mcmc_args <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">chains =</span> <span class="dv">3</span>, <span class="at">iter =</span> <span class="dv">1000</span>, <span class="at">cores =</span> <span class="dv">3</span>)</span>
<span id="cb226-2"><a href="13.5-efficient-grids.html#cb226-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb226-3"><a href="13.5-efficient-grids.html#cb226-3" aria-hidden="true" tabindex="-1"></a><span class="fu">linear_reg</span>() <span class="sc">%&gt;%</span> <span class="fu">set_engine</span>(<span class="st">&quot;stan&quot;</span>, <span class="sc">!!!</span>mcmc_args)</span>
<span id="cb226-4"><a href="13.5-efficient-grids.html#cb226-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Linear Regression Model Specification (regression)</span></span>
<span id="cb226-5"><a href="13.5-efficient-grids.html#cb226-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb226-6"><a href="13.5-efficient-grids.html#cb226-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Engine-Specific Arguments:</span></span>
<span id="cb226-7"><a href="13.5-efficient-grids.html#cb226-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   chains = 3</span></span>
<span id="cb226-8"><a href="13.5-efficient-grids.html#cb226-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   iter = 1000</span></span>
<span id="cb226-9"><a href="13.5-efficient-grids.html#cb226-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   cores = 3</span></span>
<span id="cb226-10"><a href="13.5-efficient-grids.html#cb226-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb226-11"><a href="13.5-efficient-grids.html#cb226-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Computational engine: stan</span></span></code></pre></div>
<p>Recipe selectors are another place where you might want access to global variables. Suppose you have a recipe step that should use all of the predictors in the cell data that were measured using the second optical channel. We can create a vector of these column names:</p>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb227-1"><a href="13.5-efficient-grids.html#cb227-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb227-2"><a href="13.5-efficient-grids.html#cb227-2" aria-hidden="true" tabindex="-1"></a>ch_2_vars <span class="ot">&lt;-</span> <span class="fu">str_subset</span>(<span class="fu">names</span>(cells), <span class="st">&quot;ch_2&quot;</span>)</span>
<span id="cb227-3"><a href="13.5-efficient-grids.html#cb227-3" aria-hidden="true" tabindex="-1"></a>ch_2_vars</span>
<span id="cb227-4"><a href="13.5-efficient-grids.html#cb227-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;avg_inten_ch_2&quot;   &quot;total_inten_ch_2&quot;</span></span></code></pre></div>
<p>We could hard-code these into a recipe step but it would be better to reference them programmatically in case the data change. Two ways to do this are:</p>
<div class="sourceCode" id="cb228"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb228-1"><a href="13.5-efficient-grids.html#cb228-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Still uses a reference to global data (~_~;)</span></span>
<span id="cb228-2"><a href="13.5-efficient-grids.html#cb228-2" aria-hidden="true" tabindex="-1"></a><span class="fu">recipe</span>(class <span class="sc">~</span> ., <span class="at">data =</span> cells) <span class="sc">%&gt;%</span> </span>
<span id="cb228-3"><a href="13.5-efficient-grids.html#cb228-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_spatialsign</span>(<span class="fu">all_of</span>(ch_2_vars))</span>
<span id="cb228-4"><a href="13.5-efficient-grids.html#cb228-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Recipe</span></span>
<span id="cb228-5"><a href="13.5-efficient-grids.html#cb228-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb228-6"><a href="13.5-efficient-grids.html#cb228-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Inputs:</span></span>
<span id="cb228-7"><a href="13.5-efficient-grids.html#cb228-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb228-8"><a href="13.5-efficient-grids.html#cb228-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       role #variables</span></span>
<span id="cb228-9"><a href="13.5-efficient-grids.html#cb228-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    outcome          1</span></span>
<span id="cb228-10"><a href="13.5-efficient-grids.html#cb228-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  predictor         56</span></span>
<span id="cb228-11"><a href="13.5-efficient-grids.html#cb228-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb228-12"><a href="13.5-efficient-grids.html#cb228-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Operations:</span></span>
<span id="cb228-13"><a href="13.5-efficient-grids.html#cb228-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb228-14"><a href="13.5-efficient-grids.html#cb228-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Spatial sign on  all_of(ch_2_vars)</span></span>
<span id="cb228-15"><a href="13.5-efficient-grids.html#cb228-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-16"><a href="13.5-efficient-grids.html#cb228-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Inserts the values into the step ヽ(•‿•)ノ</span></span>
<span id="cb228-17"><a href="13.5-efficient-grids.html#cb228-17" aria-hidden="true" tabindex="-1"></a><span class="fu">recipe</span>(class <span class="sc">~</span> ., <span class="at">data =</span> cells) <span class="sc">%&gt;%</span> </span>
<span id="cb228-18"><a href="13.5-efficient-grids.html#cb228-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_spatialsign</span>(<span class="sc">!!!</span>ch_2_vars)</span>
<span id="cb228-19"><a href="13.5-efficient-grids.html#cb228-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Recipe</span></span>
<span id="cb228-20"><a href="13.5-efficient-grids.html#cb228-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb228-21"><a href="13.5-efficient-grids.html#cb228-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Inputs:</span></span>
<span id="cb228-22"><a href="13.5-efficient-grids.html#cb228-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb228-23"><a href="13.5-efficient-grids.html#cb228-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       role #variables</span></span>
<span id="cb228-24"><a href="13.5-efficient-grids.html#cb228-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    outcome          1</span></span>
<span id="cb228-25"><a href="13.5-efficient-grids.html#cb228-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  predictor         56</span></span>
<span id="cb228-26"><a href="13.5-efficient-grids.html#cb228-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb228-27"><a href="13.5-efficient-grids.html#cb228-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Operations:</span></span>
<span id="cb228-28"><a href="13.5-efficient-grids.html#cb228-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb228-29"><a href="13.5-efficient-grids.html#cb228-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Spatial sign on  &quot;avg_inten_ch_2&quot;, &quot;total_inten_ch_2&quot;</span></span></code></pre></div>
<p>The latter is better for parallel processing because all of the needed information is embedded in the recipe object.</p>
</div>
<div id="racing" class="section level3" number="13.5.5">
<h3><span class="header-section-number">13.5.5</span> Racing methods</h3>
<p>One issue with grid search is that all models need to be fit across all resamples before any tuning parameters can be evaluated. It would be helpful if instead, at some point during tuning, an interim analysis could be conducted to eliminate any truly awful parameter candidates. This would be akin to <em>futility analysis</em> in clinical trials. If a new drug is performing excessively poorly (or well), it is potentially unethical to wait until the trial finishes to make a decision.</p>
<p>In machine learning, the set of techniques called <em>racing methods</em> provide a similar function <span class="citation">(<a href="#ref-maron1994hoeffding" role="doc-biblioref">Maron and Moore 1994</a>)</span>. Here, the tuning process evaluates all models on an initial subset of resamples. Based on their current performance metrics, some parameter sets are not considered in subsequent resamples.</p>
<p>As an example, in the multilayer perceptron tuning process with a regular grid explored in this chapter, what would the results look like after only the first three folds? Using techniques similar to those shown in Chapter <a href="11-compare.html#compare">11</a>, we can fit a model where the outcome is the resampled area under the ROC curve and the predictor is an indicator for the parameter combination. The model takes the resample-to-resample effect into account and produces point and interval estimates for each parameter setting. The results of the model are one-sided 95% confidence intervals that measure the loss of the ROC value relative to the currently best performing parameters.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:racing-process"></span>
<img src="figures/racing-process-1.png" alt="The racing process for 20 tuning parameters and 10 resamples. The analysis is conducted at the first, third, and last resample. As the number of resamples increases, the confidence intervals show some model configurations that do not have confidence intervals that overlap with zero. These are excluded from subsequent resamples." width="80%" />
<p class="caption">
Figure 13.9: The racing process for 20 tuning parameters and 10 resamples.
</p>
</div>
<p>Figure <a href="13.5-efficient-grids.html#fig:racing-process">13.9</a> shows the results at several iterations in the process. The points shown in the panel with the first iteration show single ROC AUC values. As iterations progress, the points are averages of the resampled ROC statistics.</p>
<p>On the third iteration, the leading model configuration has changed and the algorithm computes one-sided confidence intervals. Any parameter set whose confidence interval includes zero would lack evidence that its performance is not statistically different from the best results. We retain 14 settings; these are resampled more. The remaining 6 submodels are no longer considered.</p>
<p>The process continues to resample configurations that remain and the statistical analysis repeats with the current results. More submodels may be removed from consideration. Prior to the final resample, almost all submodels are eliminated and, at the last iteration, only 2 remain.<a href="#fn27" class="footnote-ref" id="fnref27"><sup>27</sup></a></p>
<div class="rmdwarning">
<p>Racing methods can be more efficient than basic grid search as long as the interim analysis is fast and some parameter settings have poor performance. It also is most helpful when the model does <em>not</em> have the ability to exploit submodel predictions.</p>
</div>
<p>The <span class="pkg">finetune</span> package contains functions for racing. The <code>tune_race_anova()</code> function conducts an Analysis of Variance (ANOVA) model to test for statistical significance of the different model configurations. The syntax to reproduce the filtering shown previously is:</p>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb229-1"><a href="13.5-efficient-grids.html#cb229-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(finetune)</span>
<span id="cb229-2"><a href="13.5-efficient-grids.html#cb229-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb229-3"><a href="13.5-efficient-grids.html#cb229-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1308</span>)</span>
<span id="cb229-4"><a href="13.5-efficient-grids.html#cb229-4" aria-hidden="true" tabindex="-1"></a>mlp_sfd_race <span class="ot">&lt;-</span></span>
<span id="cb229-5"><a href="13.5-efficient-grids.html#cb229-5" aria-hidden="true" tabindex="-1"></a>  mlp_wflow <span class="sc">%&gt;%</span></span>
<span id="cb229-6"><a href="13.5-efficient-grids.html#cb229-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tune_race_anova</span>(</span>
<span id="cb229-7"><a href="13.5-efficient-grids.html#cb229-7" aria-hidden="true" tabindex="-1"></a>    cell_folds,</span>
<span id="cb229-8"><a href="13.5-efficient-grids.html#cb229-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">grid =</span> <span class="dv">20</span>,</span>
<span id="cb229-9"><a href="13.5-efficient-grids.html#cb229-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">param_info =</span> mlp_param,</span>
<span id="cb229-10"><a href="13.5-efficient-grids.html#cb229-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">metrics =</span> roc_res,</span>
<span id="cb229-11"><a href="13.5-efficient-grids.html#cb229-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">control =</span> <span class="fu">control_race</span>(<span class="at">verbose_elim =</span> <span class="cn">TRUE</span>)</span>
<span id="cb229-12"><a href="13.5-efficient-grids.html#cb229-12" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<p>The arguments mirror those of <code>tune_grid()</code>. The function <code>control_race()</code> has options for the elimination procedure.</p>
<p>As shown in the animation above, there were 2 tuning parameter combinations under consideration once the full set of resamples were evaluated. <code>show_best()</code> returns the best models (ranked by performance) but only returns the configurations that were never eliminated:</p>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb230-1"><a href="13.5-efficient-grids.html#cb230-1" aria-hidden="true" tabindex="-1"></a><span class="fu">show_best</span>(mlp_sfd_race, <span class="at">n =</span> <span class="dv">10</span>)</span>
<span id="cb230-2"><a href="13.5-efficient-grids.html#cb230-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 2 × 10</span></span>
<span id="cb230-3"><a href="13.5-efficient-grids.html#cb230-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   hidden_units penalty epochs num_comp .metric .estimator  mean     n std_err</span></span>
<span id="cb230-4"><a href="13.5-efficient-grids.html#cb230-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          &lt;int&gt;   &lt;dbl&gt;  &lt;int&gt;    &lt;int&gt; &lt;chr&gt;   &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt;</span></span>
<span id="cb230-5"><a href="13.5-efficient-grids.html#cb230-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1            8  0.814     177       15 roc_auc binary     0.887    10 0.0103 </span></span>
<span id="cb230-6"><a href="13.5-efficient-grids.html#cb230-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2            3  0.0402    151       10 roc_auc binary     0.885    10 0.00810</span></span>
<span id="cb230-7"><a href="13.5-efficient-grids.html#cb230-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # … with 1 more variable: .config &lt;chr&gt;</span></span></code></pre></div>
<p>There are other interim analysis techniques for discarding settings. For example, <span class="citation">Krueger, Panknin, and Braun (<a href="#ref-krueger15a" role="doc-biblioref">2015</a>)</span> use traditional sequential analysis methods whereas <span class="citation">Max Kuhn (<a href="#ref-kuhn2014futility" role="doc-biblioref">2014</a>)</span> treats the data as a sports competition and uses the Bradley-Terry model <span class="citation">(<a href="#ref-bradley1952rank" role="doc-biblioref">Bradley and Terry 1952</a>)</span> to measure the winning ability of parameter settings.</p>
</div>
</div>
<h3>REFERENCES</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-bradley1952rank" class="csl-entry">
Bradley, R, and M Terry. 1952. <span>“Rank Analysis of Incomplete Block Designs: <span>I.</span> The Method of Paired Comparisons.”</span> <em>Biometrika</em> 39 (3/4): 324–45.
</div>
<div id="ref-Friedman:1991p109" class="csl-entry">
Friedman, J. 1991. <span>“Multivariate Adaptive Regression Splines.”</span> <em>The Annals of Statistics</em> 19 (1): 1–141.
</div>
<div id="ref-Geladi:1986" class="csl-entry">
Geladi, P., and B Kowalski. 1986. <span>“Partial Least-Squares Regression: A Tutorial.”</span> <em>Analytica Chimica Acta</em> 185: 1–17.
</div>
<div id="ref-krueger15a" class="csl-entry">
Krueger, T, D Panknin, and M Braun. 2015. <span>“Fast Cross-Validation via Sequential Testing.”</span> <em>Journal of Machine Learning Research</em> 16 (33): 1103–55.
</div>
<div id="ref-kuhn2014futility" class="csl-entry">
Kuhn, Max. 2014. <span>“Futility Analysis in the Cross-Validation of Machine Learning Models.”</span> <a href="https://arxiv.org/abs/1405.6974">https://arxiv.org/abs/1405.6974</a>.
</div>
<div id="ref-apm" class="csl-entry">
Kuhn, M, and K Johnson. 2013. <em>Applied Predictive Modeling</em>. Springer.
</div>
<div id="ref-maron1994hoeffding" class="csl-entry">
Maron, O, and A Moore. 1994. <span>“Hoeffding Races: Accelerating Model Selection Search for Classification and Function Approximation.”</span> In <em>Advances in Neural Information Processing Systems</em>, 59–66.
</div>
<div id="ref-wickham2019advanced" class="csl-entry">
Wickham, H. 2019. <em>Advanced r</em>. 2nd ed. Chapman &amp; Hall/CRC the r Series. Taylor &amp; Francis. <a href="https://doi.org/10.1201/9781351201315">https://doi.org/10.1201/9781351201315</a>.
</div>
</div>
<div class="footnotes">
<hr />
<ol start="27">
<li id="fn27"><p>See <span class="citation">Max Kuhn (<a href="#ref-kuhn2014futility" role="doc-biblioref">2014</a>)</span> for more details on the computational aspects of this approach.<a href="13.5-efficient-grids.html#fnref27" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
<p style="text-align: center;">
<a href="13.4-tuning-usemodels.html"><button class="btn btn-default">Previous</button></a>
<a href="13.6-grid-summary.html"><button class="btn btn-default">Next</button></a>
</p>
</div>
</div>


</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});

</script>

</body>
</html>
