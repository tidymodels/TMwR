<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="10.2 Resampling Methods | Tidy Modeling with R" />
<meta property="og:type" content="book" />
<meta property="og:image" content="/images/cover.png" />
<meta property="og:description" content="The tidymodels framework is a collection of R packages for modeling and machine learning using tidyverse principles. This book provides a thorough introduction to how to use tidymodels, and an outline of good methodology and statistical practice for phases of the modeling process." />
<meta name="github-repo" content="tidymodels/TMwR" />

<meta name="author" content="Max Kuhn and Julia Silge" />


<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<meta name="description" content="The tidymodels framework is a collection of R packages for modeling and machine learning using tidyverse principles. This book provides a thorough introduction to how to use tidymodels, and an outline of good methodology and statistical practice for phases of the modeling process.">

<title>10.2 Resampling Methods | Tidy Modeling with R</title>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="libs/navigation-1.1/tabsets.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
/* show arrow before summary tag as in bootstrap
TODO: remove if boostrap in updated in html_document (rmarkdown#1485) */
details > summary {
  display: list-item;
  cursor: pointer;
}
</style>
</head>

<body>

<div class="container-fluid main-container">


<div class="row">
<div class="col-sm-12">
<div id="TOC">
<ul>
<li class="has-sub"><a href="index.html#hello-world">Hello World</a>
<ul>
<li><a href="acknowledgments.html#acknowledgments">Acknowledgments</a></li>
<li><a href="using-code-examples.html#using-code-examples">Using Code Examples</a></li>
</ul></li>
<li class="part"><span><b>Introduction</b></span></li>
<li class="has-sub"><a href="1-software-modeling.html#software-modeling"><span class="toc-section-number">1</span> Software for modeling</a>
<ul>
<li><a href="1.1-fundamentals-for-modeling-software.html#fundamentals-for-modeling-software"><span class="toc-section-number">1.1</span> Fundamentals for Modeling Software</a></li>
<li class="has-sub"><a href="1.2-model-types.html#model-types"><span class="toc-section-number">1.2</span> Types of Models</a>
<ul>
<li><a href="1.2-model-types.html#descriptive-models">Descriptive models</a></li>
<li><a href="1.2-model-types.html#inferential-models">Inferential models</a></li>
<li><a href="1.2-model-types.html#predictive-models">Predictive models</a></li>
</ul></li>
<li><a href="1.3-connections-between-types-of-models.html#connections-between-types-of-models"><span class="toc-section-number">1.3</span> Connections Between Types of Models</a></li>
<li><a href="1.4-model-terminology.html#model-terminology"><span class="toc-section-number">1.4</span> Some Terminology</a></li>
<li><a href="1.5-model-phases.html#model-phases"><span class="toc-section-number">1.5</span> How Does Modeling Fit into the Data Analysis Process?</a></li>
<li><a href="1.6-software-summary.html#software-summary"><span class="toc-section-number">1.6</span> Chapter Summary</a></li>
</ul></li>
<li class="has-sub"><a href="2-tidyverse.html#tidyverse"><span class="toc-section-number">2</span> A Tidyverse Primer</a>
<ul>
<li class="has-sub"><a href="2.1-tidyverse-principles.html#tidyverse-principles"><span class="toc-section-number">2.1</span> Tidyverse Principles</a>
<ul>
<li><a href="2.1-tidyverse-principles.html#design-for-humans"><span class="toc-section-number">2.1.1</span> Design for humans</a></li>
<li><a href="2.1-tidyverse-principles.html#reuse-existing-data-structures"><span class="toc-section-number">2.1.2</span> Reuse existing data structures</a></li>
<li><a href="2.1-tidyverse-principles.html#design-for-the-pipe-and-functional-programming"><span class="toc-section-number">2.1.3</span> Design for the pipe and functional programming</a></li>
</ul></li>
<li><a href="2.2-examples-of-tidyverse-syntax.html#examples-of-tidyverse-syntax"><span class="toc-section-number">2.2</span> Examples of Tidyverse Syntax</a></li>
<li><a href="2.3-chapter-summary.html#chapter-summary"><span class="toc-section-number">2.3</span> Chapter Summary</a></li>
</ul></li>
<li class="has-sub"><a href="3-base-r.html#base-r"><span class="toc-section-number">3</span> A Review of R Modeling Fundamentals</a>
<ul>
<li><a href="3.1-an-example.html#an-example"><span class="toc-section-number">3.1</span> An Example</a></li>
<li><a href="3.2-formula.html#formula"><span class="toc-section-number">3.2</span> What Does the R Formula Do?</a></li>
<li><a href="3.3-tidiness-modeling.html#tidiness-modeling"><span class="toc-section-number">3.3</span> Why Tidiness is Important for Modeling</a></li>
<li><a href="3.4-combining-base-r-models-and-the-tidyverse.html#combining-base-r-models-and-the-tidyverse"><span class="toc-section-number">3.4</span> Combining Base R Models and the Tidyverse</a></li>
<li><a href="3.5-the-tidymodels-metapackage.html#the-tidymodels-metapackage"><span class="toc-section-number">3.5</span> The tidymodels Metapackage</a></li>
<li><a href="3.6-chapter-summary-1.html#chapter-summary-1"><span class="toc-section-number">3.6</span> Chapter Summary</a></li>
</ul></li>
<li class="part"><span><b>Modeling Basics</b></span></li>
<li class="has-sub"><a href="4-ames.html#ames"><span class="toc-section-number">4</span> The Ames Housing Data</a>
<ul>
<li><a href="4.1-exploring-features-of-homes-in-ames.html#exploring-features-of-homes-in-ames"><span class="toc-section-number">4.1</span> Exploring Features of Homes in Ames</a></li>
<li><a href="4.2-ames-summary.html#ames-summary"><span class="toc-section-number">4.2</span> Chapter Summary</a></li>
</ul></li>
<li class="has-sub"><a href="5-splitting.html#splitting"><span class="toc-section-number">5</span> Spending our Data</a>
<ul>
<li><a href="5.1-splitting-methods.html#splitting-methods"><span class="toc-section-number">5.1</span> Common Methods for Splitting Data</a></li>
<li><a href="5.2-what-about-a-validation-set.html#what-about-a-validation-set"><span class="toc-section-number">5.2</span> What About a Validation Set?</a></li>
<li><a href="5.3-multi-level-data.html#multi-level-data"><span class="toc-section-number">5.3</span> Multi-Level Data</a></li>
<li><a href="5.4-other-considerations-for-a-data-budget.html#other-considerations-for-a-data-budget"><span class="toc-section-number">5.4</span> Other Considerations for a Data Budget</a></li>
<li><a href="5.5-splitting-summary.html#splitting-summary"><span class="toc-section-number">5.5</span> Chapter Summary</a></li>
</ul></li>
<li class="has-sub"><a href="6-models.html#models"><span class="toc-section-number">6</span> Fitting Models with parsnip</a>
<ul>
<li><a href="6.1-create-a-model.html#create-a-model"><span class="toc-section-number">6.1</span> Create a Model</a></li>
<li><a href="6.2-use-the-model-results.html#use-the-model-results"><span class="toc-section-number">6.2</span> Use the Model Results</a></li>
<li><a href="6.3-parsnip-predictions.html#parsnip-predictions"><span class="toc-section-number">6.3</span> Make Predictions</a></li>
<li><a href="6.4-parsnip-extension-packages.html#parsnip-extension-packages"><span class="toc-section-number">6.4</span> parsnip-Extension Packages</a></li>
<li><a href="6.5-parsnip-addin.html#parsnip-addin"><span class="toc-section-number">6.5</span> Creating Model Specifications</a></li>
<li><a href="6.6-models-summary.html#models-summary"><span class="toc-section-number">6.6</span> Chapter Summary</a></li>
</ul></li>
<li class="has-sub"><a href="7-workflows.html#workflows"><span class="toc-section-number">7</span> A Model Workflow</a>
<ul>
<li><a href="7.1-begin-model-end.html#begin-model-end"><span class="toc-section-number">7.1</span> Where Does the Model Begin and End?</a></li>
<li><a href="7.2-workflow-basics.html#workflow-basics"><span class="toc-section-number">7.2</span> Workflow Basics</a></li>
<li><a href="7.3-adding-raw-variables-to-the-workflow.html#adding-raw-variables-to-the-workflow"><span class="toc-section-number">7.3</span> Adding Raw Variables to the <code>workflow()</code></a></li>
<li class="has-sub"><a href="7.4-workflow-encoding.html#workflow-encoding"><span class="toc-section-number">7.4</span> How Does a <code>workflow()</code> Use the Formula?</a>
<ul>
<li><a href="7.4-workflow-encoding.html#tree-based-models">Tree-based models</a></li>
<li><a href="7.4-workflow-encoding.html#special-model-formulas"><span class="toc-section-number">7.4.1</span> Special formulas and in-line functions</a></li>
</ul></li>
<li><a href="7.5-workflow-sets-intro.html#workflow-sets-intro"><span class="toc-section-number">7.5</span> Creating Multiple Workflows at Once</a></li>
<li><a href="7.6-evaluating-the-test-set.html#evaluating-the-test-set"><span class="toc-section-number">7.6</span> Evaluating the Test Set</a></li>
<li><a href="7.7-workflows-summary.html#workflows-summary"><span class="toc-section-number">7.7</span> Chapter Summary</a></li>
</ul></li>
<li class="has-sub"><a href="8-recipes.html#recipes"><span class="toc-section-number">8</span> Feature Engineering with recipes</a>
<ul>
<li><a href="8.1-a-simple-recipe-for-the-ames-housing-data.html#a-simple-recipe-for-the-ames-housing-data"><span class="toc-section-number">8.1</span> A Simple <code>recipe()</code> for the Ames Housing Data</a></li>
<li><a href="8.2-using-recipes.html#using-recipes"><span class="toc-section-number">8.2</span> Using Recipes</a></li>
<li><a href="8.3-how-data-are-used-by-the-recipe.html#how-data-are-used-by-the-recipe"><span class="toc-section-number">8.3</span> How Data are Used by the <code>recipe()</code></a></li>
<li class="has-sub"><a href="8.4-example-steps.html#example-steps"><span class="toc-section-number">8.4</span> Examples of <code>recipe()</code> Steps</a>
<ul>
<li><a href="8.4-example-steps.html#dummies"><span class="toc-section-number">8.4.1</span> Encoding qualitative data in a numeric format</a></li>
<li><a href="8.4-example-steps.html#interaction-terms"><span class="toc-section-number">8.4.2</span> Interaction terms</a></li>
<li><a href="8.4-example-steps.html#spline-functions"><span class="toc-section-number">8.4.3</span> Spline functions</a></li>
<li><a href="8.4-example-steps.html#feature-extraction"><span class="toc-section-number">8.4.4</span> Feature extraction</a></li>
<li><a href="8.4-example-steps.html#row-sampling-steps"><span class="toc-section-number">8.4.5</span> Row sampling steps</a></li>
<li><a href="8.4-example-steps.html#general-transformations"><span class="toc-section-number">8.4.6</span> General transformations</a></li>
<li><a href="8.4-example-steps.html#natural-language-processing"><span class="toc-section-number">8.4.7</span> Natural language processing</a></li>
</ul></li>
<li><a href="8.5-skip-equals-true.html#skip-equals-true"><span class="toc-section-number">8.5</span> Skipping Steps for New Data</a></li>
<li><a href="8.6-tidy-a-recipe.html#tidy-a-recipe"><span class="toc-section-number">8.6</span> Tidy a <code>recipe()</code></a></li>
<li><a href="8.7-column-roles.html#column-roles"><span class="toc-section-number">8.7</span> Column Roles</a></li>
<li><a href="8.8-recipes-summary.html#recipes-summary"><span class="toc-section-number">8.8</span> Chapter Summary</a></li>
</ul></li>
<li class="has-sub"><a href="9-performance.html#performance"><span class="toc-section-number">9</span> Judging Model Effectiveness</a>
<ul>
<li><a href="9.1-performance-metrics-and-inference.html#performance-metrics-and-inference"><span class="toc-section-number">9.1</span> Performance Metrics and Inference</a></li>
<li><a href="9.2-regression-metrics.html#regression-metrics"><span class="toc-section-number">9.2</span> Regression Metrics</a></li>
<li><a href="9.3-binary-classification-metrics.html#binary-classification-metrics"><span class="toc-section-number">9.3</span> Binary Classification Metrics</a></li>
<li><a href="9.4-multi-class-classification-metrics.html#multi-class-classification-metrics"><span class="toc-section-number">9.4</span> Multi-Class Classification Metrics</a></li>
<li><a href="9.5-performance-summary.html#performance-summary"><span class="toc-section-number">9.5</span> Chapter Summary</a></li>
</ul></li>
<li class="part"><span><b>Tools for Creating Effective Models</b></span></li>
<li class="has-sub"><a href="10-resampling.html#resampling"><span class="toc-section-number">10</span> Resampling for Evaluating Performance</a>
<ul>
<li><a href="10.1-resampling-resubstition.html#resampling-resubstition"><span class="toc-section-number">10.1</span> The Resubstitution Approach</a></li>
<li class="has-sub"><a href="10.2-resampling-methods.html#resampling-methods"><span class="toc-section-number">10.2</span> Resampling Methods</a>
<ul>
<li><a href="10.2-resampling-methods.html#cv"><span class="toc-section-number">10.2.1</span> Cross-validation</a></li>
<li><a href="10.2-resampling-methods.html#repeated-cross-validation">Repeated cross-validation</a></li>
<li><a href="10.2-resampling-methods.html#leave-one-out-cross-validation">Leave-one-out cross-validation</a></li>
<li><a href="10.2-resampling-methods.html#monte-carlo-cross-validation">Monte Carlo cross-validation</a></li>
<li><a href="10.2-resampling-methods.html#validation"><span class="toc-section-number">10.2.2</span> Validation sets</a></li>
<li><a href="10.2-resampling-methods.html#bootstrap"><span class="toc-section-number">10.2.3</span> Bootstrapping</a></li>
<li><a href="10.2-resampling-methods.html#rolling"><span class="toc-section-number">10.2.4</span> Rolling forecasting origin resampling</a></li>
</ul></li>
<li><a href="10.3-resampling-performance.html#resampling-performance"><span class="toc-section-number">10.3</span> Estimating Performance</a></li>
<li><a href="10.4-parallel.html#parallel"><span class="toc-section-number">10.4</span> Parallel Processing</a></li>
<li><a href="10.5-extract.html#extract"><span class="toc-section-number">10.5</span> Saving the Resampled Objects</a></li>
<li><a href="10.6-resampling-summary.html#resampling-summary"><span class="toc-section-number">10.6</span> Chapter Summary</a></li>
</ul></li>
<li class="has-sub"><a href="11-compare.html#compare"><span class="toc-section-number">11</span> Comparing Models with Resampling</a>
<ul>
<li><a href="11.1-workflow-set.html#workflow-set"><span class="toc-section-number">11.1</span> Creating Multiple Models with Workflow Sets</a></li>
<li><a href="11.2-resampled-stats.html#resampled-stats"><span class="toc-section-number">11.2</span> Comparing Resampled Performance Statistics</a></li>
<li><a href="11.3-simple-hypothesis-testing-methods.html#simple-hypothesis-testing-methods"><span class="toc-section-number">11.3</span> Simple Hypothesis Testing Methods</a></li>
<li class="has-sub"><a href="11.4-tidyposterior.html#tidyposterior"><span class="toc-section-number">11.4</span> Bayesian Methods</a>
<ul>
<li><a href="11.4-tidyposterior.html#the-effect-of-the-amount-of-resampling">The effect of the amount of resampling</a></li>
</ul></li>
<li><a href="11.5-compare-summary.html#compare-summary"><span class="toc-section-number">11.5</span> Chapter Summary</a></li>
</ul></li>
<li class="has-sub"><a href="12-tuning.html#tuning"><span class="toc-section-number">12</span> Model Tuning and the Dangers of Overfitting</a>
<ul>
<li><a href="12.1-model-parameters.html#model-parameters"><span class="toc-section-number">12.1</span> Model Parameters</a></li>
<li><a href="12.2-tuning-parameter-examples.html#tuning-parameter-examples"><span class="toc-section-number">12.2</span> Tuning Parameters for Different Types of Models</a></li>
<li><a href="12.3-what-to-optimize.html#what-to-optimize"><span class="toc-section-number">12.3</span> What do we Optimize?</a></li>
<li><a href="12.4-overfitting-bad.html#overfitting-bad"><span class="toc-section-number">12.4</span> The consequences of poor parameter estimates</a></li>
<li><a href="12.5-two-general-strategies-for-optimization.html#two-general-strategies-for-optimization"><span class="toc-section-number">12.5</span> Two general strategies for optimization</a></li>
<li><a href="12.6-tuning-params-tidymodels.html#tuning-params-tidymodels"><span class="toc-section-number">12.6</span> Tuning Parameters in tidymodels</a></li>
<li><a href="12.7-chapter-summary-2.html#chapter-summary-2"><span class="toc-section-number">12.7</span> Chapter Summary</a></li>
</ul></li>
<li class="has-sub"><a href="13-grid-search.html#grid-search"><span class="toc-section-number">13</span> Grid Search</a>
<ul>
<li class="has-sub"><a href="13.1-grids.html#grids"><span class="toc-section-number">13.1</span> Regular and Non-Regular Grids</a>
<ul>
<li><a href="13.1-grids.html#regular-grids">Regular grids</a></li>
<li><a href="13.1-grids.html#irregular-grids">Irregular grids</a></li>
</ul></li>
<li><a href="13.2-evaluating-grid.html#evaluating-grid"><span class="toc-section-number">13.2</span> Evaluating the Grid</a></li>
<li><a href="13.3-finalizing-the-model.html#finalizing-the-model"><span class="toc-section-number">13.3</span> Finalizing the Model</a></li>
<li><a href="13.4-tuning-usemodels.html#tuning-usemodels"><span class="toc-section-number">13.4</span> Tools for Creating Tuning Specifications</a></li>
<li class="has-sub"><a href="13.5-efficient-grids.html#efficient-grids"><span class="toc-section-number">13.5</span> Tools for Efficient Grid Search</a>
<ul>
<li><a href="13.5-efficient-grids.html#submodel-trick"><span class="toc-section-number">13.5.1</span> Submodel optimization</a></li>
<li><a href="13.5-efficient-grids.html#parallel-processing"><span class="toc-section-number">13.5.2</span> Parallel processing</a></li>
<li><a href="13.5-efficient-grids.html#benchmarking-boosted-trees"><span class="toc-section-number">13.5.3</span> Benchmarking boosted trees</a></li>
<li><a href="13.5-efficient-grids.html#access-to-global-variables"><span class="toc-section-number">13.5.4</span> Access to global variables</a></li>
<li><a href="13.5-efficient-grids.html#racing"><span class="toc-section-number">13.5.5</span> Racing methods</a></li>
</ul></li>
<li><a href="13.6-grid-summary.html#grid-summary"><span class="toc-section-number">13.6</span> Chapter Summary</a></li>
</ul></li>
<li class="has-sub"><a href="14-iterative-search.html#iterative-search"><span class="toc-section-number">14</span> Iterative Search</a>
<ul>
<li><a href="14.1-svm.html#svm"><span class="toc-section-number">14.1</span> A Support Vector Machine Model</a></li>
<li class="has-sub"><a href="14.2-bayesian-optimization.html#bayesian-optimization"><span class="toc-section-number">14.2</span> Bayesian Optimization</a>
<ul>
<li><a href="14.2-bayesian-optimization.html#a-gaussian-process-model"><span class="toc-section-number">14.2.1</span> A Gaussian process model</a></li>
<li><a href="14.2-bayesian-optimization.html#acquisition-functions"><span class="toc-section-number">14.2.2</span> Acquisition functions</a></li>
<li><a href="14.2-bayesian-optimization.html#tune-bayes"><span class="toc-section-number">14.2.3</span> The <code>tune_bayes()</code> function</a></li>
</ul></li>
<li class="has-sub"><a href="14.3-simulated-annealing.html#simulated-annealing"><span class="toc-section-number">14.3</span> Simulated Annealing</a>
<ul>
<li><a href="14.3-simulated-annealing.html#simulated-annealing-search-process"><span class="toc-section-number">14.3.1</span> Simulated annealing search process</a></li>
<li><a href="14.3-simulated-annealing.html#tune-sim-anneal"><span class="toc-section-number">14.3.2</span> The <code>tune_sim_anneal()</code> function</a></li>
</ul></li>
<li><a href="14.4-iterative-summary.html#iterative-summary"><span class="toc-section-number">14.4</span> Chapter Summary</a></li>
</ul></li>
<li class="has-sub"><a href="15-workflow-sets.html#workflow-sets"><span class="toc-section-number">15</span> Screening Many Models</a>
<ul>
<li><a href="15.1-modeling-concrete-mixture-strength.html#modeling-concrete-mixture-strength"><span class="toc-section-number">15.1</span> Modeling Concrete Mixture Strength</a></li>
<li><a href="15.2-creating-the-workflow-set.html#creating-the-workflow-set"><span class="toc-section-number">15.2</span> Creating the Workflow Set</a></li>
<li><a href="15.3-tuning-and-evaluating-the-models.html#tuning-and-evaluating-the-models"><span class="toc-section-number">15.3</span> Tuning and Evaluating the Models</a></li>
<li><a href="15.4-racing-example.html#racing-example"><span class="toc-section-number">15.4</span> Efficiently Screening Models</a></li>
<li><a href="15.5-finalizing-a-model.html#finalizing-a-model"><span class="toc-section-number">15.5</span> Finalizing a Model</a></li>
<li><a href="15.6-workflow-sets-summary.html#workflow-sets-summary"><span class="toc-section-number">15.6</span> Chapter Summary</a></li>
</ul></li>
<li class="part"><span><b>Beyond the Basics</b></span></li>
<li class="has-sub"><a href="16-dimensionality.html#dimensionality"><span class="toc-section-number">16</span> Dimensionality Reduction</a>
<ul>
<li><a href="16.1-when-problems-can-dimensionality-reduction-solve.html#when-problems-can-dimensionality-reduction-solve"><span class="toc-section-number">16.1</span> When Problems Can Dimensionality Reduction Solve?</a></li>
<li><a href="16.2-beans.html#beans"><span class="toc-section-number">16.2</span> A Picture is Worth a Thousand… Beans</a></li>
<li><a href="16.3-a-starter-recipe.html#a-starter-recipe"><span class="toc-section-number">16.3</span> A Starter Recipe</a></li>
<li class="has-sub"><a href="16.4-recipe-functions.html#recipe-functions"><span class="toc-section-number">16.4</span> Recipes in the Wild</a>
<ul>
<li><a href="16.4-recipe-functions.html#prep"><span class="toc-section-number">16.4.1</span> Preparing a recipe</a></li>
<li><a href="16.4-recipe-functions.html#bake"><span class="toc-section-number">16.4.2</span> Baking the recipe</a></li>
</ul></li>
<li class="has-sub"><a href="16.5-feature-extraction-techniques.html#feature-extraction-techniques"><span class="toc-section-number">16.5</span> Feature Extraction Techniques</a>
<ul>
<li><a href="16.5-feature-extraction-techniques.html#principal-component-analysis"><span class="toc-section-number">16.5.1</span> Principal component analysis</a></li>
<li><a href="16.5-feature-extraction-techniques.html#partial-least-squares"><span class="toc-section-number">16.5.2</span> Partial least squares</a></li>
<li><a href="16.5-feature-extraction-techniques.html#independent-component-analysis"><span class="toc-section-number">16.5.3</span> Independent component analysis</a></li>
<li><a href="16.5-feature-extraction-techniques.html#uniform-manifold-approximation-and-projection"><span class="toc-section-number">16.5.4</span> Uniform manifold approximation and projection</a></li>
</ul></li>
<li><a href="16.6-bean-models.html#bean-models"><span class="toc-section-number">16.6</span> Modeling</a></li>
<li><a href="16.7-dimensionality-summary.html#dimensionality-summary"><span class="toc-section-number">16.7</span> Chapter Summary</a></li>
</ul></li>
<li class="has-sub"><a href="17-categorical.html#categorical"><span class="toc-section-number">17</span> Encoding Categorical Data</a>
<ul>
<li><a href="17.1-is-an-encoding-necessary.html#is-an-encoding-necessary"><span class="toc-section-number">17.1</span> Is an Encoding Necessary?</a></li>
<li><a href="17.2-encoding-ordinal-predictors.html#encoding-ordinal-predictors"><span class="toc-section-number">17.2</span> Encoding Ordinal Predictors</a></li>
<li class="has-sub"><a href="17.3-using-the-outcome-for-encoding-predictors.html#using-the-outcome-for-encoding-predictors"><span class="toc-section-number">17.3</span> Using the Outcome for Encoding Predictors</a>
<ul>
<li><a href="17.3-using-the-outcome-for-encoding-predictors.html#effect-encodings-with-partial-pooling"><span class="toc-section-number">17.3.1</span> Effect encodings with partial pooling</a></li>
</ul></li>
<li><a href="17.4-feature-hashing.html#feature-hashing"><span class="toc-section-number">17.4</span> Feature Hashing</a></li>
<li><a href="17.5-more-encoding-options.html#more-encoding-options"><span class="toc-section-number">17.5</span> More Encoding Options</a></li>
<li><a href="17.6-categorical-summary.html#categorical-summary"><span class="toc-section-number">17.6</span> Chapter Summary</a></li>
</ul></li>
<li class="has-sub"><a href="18-explain.html#explain"><span class="toc-section-number">18</span> Explaining Models and Predictions</a>
<ul>
<li><a href="18.1-software-for-model-explanations.html#software-for-model-explanations"><span class="toc-section-number">18.1</span> Software for Model Explanations</a></li>
<li><a href="18.2-local-explanations.html#local-explanations"><span class="toc-section-number">18.2</span> Local Explanations</a></li>
<li><a href="18.3-global-explanations.html#global-explanations"><span class="toc-section-number">18.3</span> Global Explanations</a></li>
<li><a href="18.4-building-global-explanations-from-local-explanations.html#building-global-explanations-from-local-explanations"><span class="toc-section-number">18.4</span> Building Global Explanations from Local Explanations</a></li>
<li><a href="18.5-back-to-beans.html#back-to-beans"><span class="toc-section-number">18.5</span> Back to Beans!</a></li>
<li><a href="18.6-explain-summary.html#explain-summary"><span class="toc-section-number">18.6</span> Chapter Summary</a></li>
</ul></li>
<li class="has-sub"><a href="19-trust.html#trust"><span class="toc-section-number">19</span> When Should You Trust Your Predictions?</a>
<ul>
<li><a href="19.1-equivocal-zones.html#equivocal-zones"><span class="toc-section-number">19.1</span> Equivocal Results</a></li>
<li><a href="19.2-applicability-domains.html#applicability-domains"><span class="toc-section-number">19.2</span> Determining Model Applicability</a></li>
<li><a href="19.3-trust-summary.html#trust-summary"><span class="toc-section-number">19.3</span> Chapter Summary</a></li>
</ul></li>
<li class="has-sub"><a href="20-ensembles.html#ensembles"><span class="toc-section-number">20</span> Ensembles of Models</a>
<ul>
<li><a href="20.1-data-stack.html#data-stack"><span class="toc-section-number">20.1</span> Creating the Training Set for Stacking</a></li>
<li><a href="20.2-blend-predictions.html#blend-predictions"><span class="toc-section-number">20.2</span> Blend the Predictions</a></li>
<li><a href="20.3-fit-members.html#fit-members"><span class="toc-section-number">20.3</span> Fit the Member Models</a></li>
<li><a href="20.4-test-set-results.html#test-set-results"><span class="toc-section-number">20.4</span> Test Set Results</a></li>
<li><a href="20.5-ensembles-summary.html#ensembles-summary"><span class="toc-section-number">20.5</span> Chapter Summary</a></li>
</ul></li>
<li class="has-sub"><a href="21-inferential.html#inferential"><span class="toc-section-number">21</span> Inferential Analysis</a>
<ul>
<li><a href="21.1-inference-for-count-data.html#inference-for-count-data"><span class="toc-section-number">21.1</span> Inference for Count Data</a></li>
<li><a href="21.2-comparisons-with-two-sample-tests.html#comparisons-with-two-sample-tests"><span class="toc-section-number">21.2</span> Comparisons with Two-Sample Tests</a></li>
<li><a href="21.3-log-linear-models.html#log-linear-models"><span class="toc-section-number">21.3</span> Log-Linear Models</a></li>
<li><a href="21.4-a-more-complex-model.html#a-more-complex-model"><span class="toc-section-number">21.4</span> A More Complex Model</a></li>
<li><a href="21.5-inference-options.html#inference-options"><span class="toc-section-number">21.5</span> More Inferential Analysis</a></li>
<li><a href="21.6-inference-summary.html#inference-summary"><span class="toc-section-number">21.6</span> Chapter Summary</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li><a href="A-pre-proc-table.html#pre-proc-table"><span class="toc-section-number">A</span> Recommended Preprocessing</a></li>
<li><a href="references.html#references">REFERENCES</a></li>
</ul>
</div>
</div>
</div>
<div class="row">
<div class="col-sm-12">
<div id="resampling-methods" class="section level2" number="10.2">
<h2><span class="header-section-number">10.2</span> Resampling Methods</h2>
<p>Resampling methods are empirical simulation systems that emulate the process of using some data for modeling and different data for evaluation. Most resampling methods are iterative, meaning that this process is repeated multiple times. The diagram in Figure <a href="10.2-resampling-methods.html#fig:resampling-scheme">10.1</a> illustrates how resampling methods generally operate.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:resampling-scheme"></span>
<img src="premade/resampling.svg" alt="A diagram of the data splitting scheme from the initial data split to resampling. The first level is the training/testing set partition. The second level of splitting takes the training set and splits it into multiple 'analysis' and 'assessment' sets (which are analogous to training and test)." width="85%" />
<p class="caption">
Figure 10.1: Data splitting scheme from the initial data split to resampling.
</p>
</div>
<p>Resampling is only conducted on the training set, as you see in Figure <a href="10.2-resampling-methods.html#fig:resampling-scheme">10.1</a>. The test set is not involved. For each iteration of resampling, the data are partitioned into two subsamples:</p>
<ul>
<li><p>The model is fit with the <em>analysis set</em>.</p></li>
<li><p>The model is evaluated with the <em>assessment set</em>.</p></li>
</ul>
<p>These two subsamples are somewhat analogous to training and test sets. Our language of <em>analysis</em> and <em>assessment</em> avoids confusion with initial split of the data. These data sets are mutually exclusive. The partitioning scheme used to create the analysis and assessment sets is usually the defining characteristic of the method.</p>
<p>Suppose twenty iterations of resampling are conducted. This means that twenty separate models are fit on the analysis sets and the corresponding assessment sets produce twenty sets of performance statistics. The final estimate of performance for a model is the average of the twenty replicates of the statistics. This average has very good generalization properties and is far better than the resubstituion estimates.</p>
<p>The next section defines several commonly used resampling methods and discusses their pros and cons.</p>
<div id="cv" class="section level3" number="10.2.1">
<h3><span class="header-section-number">10.2.1</span> Cross-validation</h3>
<p>Cross-validation is a well established resampling method. While there are a number of variations, the most common cross-validation method is <em>V</em>-fold cross-validation. The data are randomly partitioned into <em>V</em> sets of roughly equal size (called the “folds”). For illustration, <em>V</em> = 3 is shown in Figure <a href="10.2-resampling-methods.html#fig:cross-validation-allocation">10.2</a> for a data set of thirty training set points with random fold allocations. The number inside the symbols is the sample number.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:cross-validation-allocation"></span>
<img src="premade/three-CV.svg" alt="A diagram of how V-fold cross-validation randomly assigns data to folds (where V equals three). A set of thirty data points are assigned to three groups of roughly the same size." width="50%" />
<p class="caption">
Figure 10.2: V-fold cross-validation randomly assigns data to folds.
</p>
</div>
<p>The color of the symbols in Figure <a href="10.2-resampling-methods.html#fig:cross-validation-allocation">10.2</a> represent their randomly assigned folds. Stratified sampling is also an option for assigning folds (previously discussed in Chapter <a href="5-splitting.html#splitting">5</a>).</p>
<p>For 3-fold cross-validation, the three iterations of resampling are illustrated in Figure <a href="10.2-resampling-methods.html#fig:cross-validation">10.3</a>. For each iteration, one fold is held out for assessment statistics and the remaining folds are substrate for the model. This process continues for each fold so that three models produce three sets of performance statistics.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:cross-validation"></span>
<img src="premade/three-CV-iter.svg" alt="A diagram of V-fold cross-validation data usage (where V equals three). For each of the three groups, the data for the fold are held out for performance while the other two are used for modeling." width="70%" />
<p class="caption">
Figure 10.3: V-fold cross-validation data usage.
</p>
</div>
<p>When <em>V</em> = 3, the analysis sets are 2/3 of the training set and each assessment set is a distinct 1/3. The final resampling estimate of performance averages each of the <em>V</em> replicates.</p>
<p>Using <em>V</em> = 3 is a good choice to illustrate cross-validation but is a poor choice in practice because it is too low to generate reliable estimates. In practice, values of <em>V</em> are most often 5 or 10; we generally prefer 10-fold cross-validation as a default because it is large enough for good results in most situations.</p>
<div class="rmdnote">
<p>What are the effects of changing <em>V</em>? Larger values result in resampling estimates with small bias but substantial variance. Smaller values of <em>V</em> have large bias but low variance. We prefer 10-fold since noise is reduced by replication, but bias is not.<a href="#fn19" class="footnote-ref" id="fnref19"><sup>19</sup></a>.</p>
</div>
<p>The primary input is the training set data frame as well as the number of folds (defaulting to 10):</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="10.2-resampling-methods.html#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1001</span>)</span>
<span id="cb137-2"><a href="10.2-resampling-methods.html#cb137-2" aria-hidden="true" tabindex="-1"></a>ames_folds <span class="ot">&lt;-</span> <span class="fu">vfold_cv</span>(ames_train, <span class="at">v =</span> <span class="dv">10</span>)</span>
<span id="cb137-3"><a href="10.2-resampling-methods.html#cb137-3" aria-hidden="true" tabindex="-1"></a>ames_folds</span>
<span id="cb137-4"><a href="10.2-resampling-methods.html#cb137-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #  10-fold cross-validation </span></span>
<span id="cb137-5"><a href="10.2-resampling-methods.html#cb137-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 10 × 2</span></span>
<span id="cb137-6"><a href="10.2-resampling-methods.html#cb137-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   splits             id    </span></span>
<span id="cb137-7"><a href="10.2-resampling-methods.html#cb137-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;list&gt;             &lt;chr&gt; </span></span>
<span id="cb137-8"><a href="10.2-resampling-methods.html#cb137-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 &lt;split [2107/235]&gt; Fold01</span></span>
<span id="cb137-9"><a href="10.2-resampling-methods.html#cb137-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 &lt;split [2107/235]&gt; Fold02</span></span>
<span id="cb137-10"><a href="10.2-resampling-methods.html#cb137-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 &lt;split [2108/234]&gt; Fold03</span></span>
<span id="cb137-11"><a href="10.2-resampling-methods.html#cb137-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 &lt;split [2108/234]&gt; Fold04</span></span>
<span id="cb137-12"><a href="10.2-resampling-methods.html#cb137-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 &lt;split [2108/234]&gt; Fold05</span></span>
<span id="cb137-13"><a href="10.2-resampling-methods.html#cb137-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 &lt;split [2108/234]&gt; Fold06</span></span>
<span id="cb137-14"><a href="10.2-resampling-methods.html#cb137-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # … with 4 more rows</span></span></code></pre></div>
<p>The column named <code>splits</code> contains the information on how to split the data (similar to the object used to create the initial training/test partition). While each row of <code>splits</code> has an embedded copy of the entire training set, R is smart enough not to make copies of the data in memory.<a href="#fn20" class="footnote-ref" id="fnref20"><sup>20</sup></a> The print method inside of the tibble shows the frequency of each: <code>[2K/220]</code> indicates that roughly two thousand samples are in the analysis set and 220 are in that particular assessment set.</p>
<p>These objects also always contain a character column called <code>id</code> that labels the partition.<a href="#fn21" class="footnote-ref" id="fnref21"><sup>21</sup></a></p>
<p>To manually retrieve the partitioned data, the <code>analysis()</code> and <code>assessment()</code> functions return the corresponding data frames:</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="10.2-resampling-methods.html#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="co"># For the first fold:</span></span>
<span id="cb138-2"><a href="10.2-resampling-methods.html#cb138-2" aria-hidden="true" tabindex="-1"></a>ames_folds<span class="sc">$</span>splits[[<span class="dv">1</span>]] <span class="sc">%&gt;%</span> <span class="fu">analysis</span>() <span class="sc">%&gt;%</span> <span class="fu">dim</span>()</span>
<span id="cb138-3"><a href="10.2-resampling-methods.html#cb138-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 2107   74</span></span></code></pre></div>
<p>The <span class="pkg">tidymodels</span> packages, such as <a href="https://tune.tidymodels.org/"><span class="pkg">tune</span></a>, contain high-level user interfaces so that functions like <code>analysis()</code> are not generally needed for day-to-day work. Chapter <a href="10-resampling.html#resampling">10</a> demonstrates functions to fit a model over these resamples.</p>
<p>There are a variety of variations on cross-validation; we’ll go through the most important ones.</p>
</div>
<div id="repeated-cross-validation" class="section level3 unnumbered">
<h3>Repeated cross-validation</h3>
<p>The most important variation on cross-validation is repeated <em>V</em>-fold cross-validation. Depending on the size or other characteristics of the data, the resampling estimate produced by <em>V</em>-fold cross-validation may be excessively noisy.<a href="#fn22" class="footnote-ref" id="fnref22"><sup>22</sup></a> As with many statistical problems, one way to reduce noise is to gather more data. For cross-validation, this means averaging more than <em>V</em> statistics.</p>
<p>To create <em>R</em> repeats of <em>V</em>-fold cross-validation, the same fold generation process is done <em>R</em> times to generate <em>R</em> collections of <em>V</em> partitions. Now, instead of averaging <em>V</em> statistics, <span class="math inline">\(V \times R\)</span> statistics produce the final resampling estimate. Due to the Central Limit Theorem, the summary statistics from each model tend toward a normal distribution, as long as we have a lot of data relative to <span class="math inline">\(V \times R\)</span>.</p>
<p>Consider the Ames data. On average, 10-fold cross-validation uses assessment sets that contain roughly 234 properties. If RMSE is the statistic of choice, we can denote that estimate’s standard deviation as <span class="math inline">\(\sigma\)</span>. With simple 10-fold cross-validation, the standard error of the mean RMSE is <span class="math inline">\(\sigma/\sqrt{10}\)</span>. If this is too noisy, repeats reduce the standard error to <span class="math inline">\(\sigma/\sqrt{10R}\)</span>. For 10-fold cross-validation with <span class="math inline">\(R\)</span> replicates, the plot in Figure <a href="10.2-resampling-methods.html#fig:variance-reduction">10.4</a> shows how quickly the standard error<a href="#fn23" class="footnote-ref" id="fnref23"><sup>23</sup></a> decreases with replicates.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:variance-reduction"></span>
<img src="figures/variance-reduction-1.png" alt="The relationship between the relative variance in performance estimates versus the number of cross-validation repeats. As the repeats increase, the variance is reduced in a harmonically decreasing pattern with diminishing returns for large number of replicates."  />
<p class="caption">
Figure 10.4: Relationship between the relative variance in performance estimates versus the number of cross-validation repeats.
</p>
</div>
<p>Larger number of replicates tend to have less impact on the standard error. However, if the baseline value of <span class="math inline">\(\sigma\)</span> is impractically large, the diminishing returns on replication may still be worth the extra computational costs.</p>
<p>To create repeats, invoke <code>vfold_cv()</code> with an additional argument <code>repeats</code>:</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="10.2-resampling-methods.html#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vfold_cv</span>(ames_train, <span class="at">v =</span> <span class="dv">10</span>, <span class="at">repeats =</span> <span class="dv">5</span>)</span>
<span id="cb139-2"><a href="10.2-resampling-methods.html#cb139-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #  10-fold cross-validation repeated 5 times </span></span>
<span id="cb139-3"><a href="10.2-resampling-methods.html#cb139-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 50 × 3</span></span>
<span id="cb139-4"><a href="10.2-resampling-methods.html#cb139-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   splits             id      id2   </span></span>
<span id="cb139-5"><a href="10.2-resampling-methods.html#cb139-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;list&gt;             &lt;chr&gt;   &lt;chr&gt; </span></span>
<span id="cb139-6"><a href="10.2-resampling-methods.html#cb139-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 &lt;split [2107/235]&gt; Repeat1 Fold01</span></span>
<span id="cb139-7"><a href="10.2-resampling-methods.html#cb139-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 &lt;split [2107/235]&gt; Repeat1 Fold02</span></span>
<span id="cb139-8"><a href="10.2-resampling-methods.html#cb139-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 &lt;split [2108/234]&gt; Repeat1 Fold03</span></span>
<span id="cb139-9"><a href="10.2-resampling-methods.html#cb139-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 &lt;split [2108/234]&gt; Repeat1 Fold04</span></span>
<span id="cb139-10"><a href="10.2-resampling-methods.html#cb139-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 &lt;split [2108/234]&gt; Repeat1 Fold05</span></span>
<span id="cb139-11"><a href="10.2-resampling-methods.html#cb139-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 &lt;split [2108/234]&gt; Repeat1 Fold06</span></span>
<span id="cb139-12"><a href="10.2-resampling-methods.html#cb139-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # … with 44 more rows</span></span></code></pre></div>
</div>
<div id="leave-one-out-cross-validation" class="section level3 unnumbered">
<h3>Leave-one-out cross-validation</h3>
<p>One variation of cross-validation is leave-one-out (LOO) cross-validation where <em>V</em> is the number of data points in the training set. If there are <span class="math inline">\(n\)</span> training set samples, <span class="math inline">\(n\)</span> models are fit using <span class="math inline">\(n-1\)</span> rows of the training set. Each model predicts the single excluded data point. At the end of resampling, the <span class="math inline">\(n\)</span> predictions are pooled to produce a single performance statistic.</p>
<p>Leave-one-out methods are deficient compared to almost any other method. For anything but pathologically small samples, LOO is computationally excessive and it may not have good statistical properties. Although the <span class="pkg">rsample</span> package contains a <code>loo_cv()</code> function, these objects are not generally integrated into the broader tidymodels frameworks.</p>
</div>
<div id="monte-carlo-cross-validation" class="section level3 unnumbered">
<h3>Monte Carlo cross-validation</h3>
<p>Another variant of <em>V</em>-fold cross-validation is Monte Carlo cross-validation (MCCV, <span class="citation">Xu and Liang (<a href="#ref-xu2001monte" role="doc-biblioref">2001</a>)</span>). Like <em>V</em>-fold cross-validation, it allocates a fixed proportion of data to the assessment sets. The difference between MCCV and regular cross-validation is that, for MCCV, this proportion of the data is randomly selected each time. This results in assessment sets that are not mutually exclusive. To create these resampling objects:</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="10.2-resampling-methods.html#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mc_cv</span>(ames_train, <span class="at">prop =</span> <span class="dv">9</span><span class="sc">/</span><span class="dv">10</span>, <span class="at">times =</span> <span class="dv">20</span>)</span>
<span id="cb140-2"><a href="10.2-resampling-methods.html#cb140-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # Monte Carlo cross-validation (0.9/0.1) with 20 resamples  </span></span>
<span id="cb140-3"><a href="10.2-resampling-methods.html#cb140-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 20 × 2</span></span>
<span id="cb140-4"><a href="10.2-resampling-methods.html#cb140-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   splits             id        </span></span>
<span id="cb140-5"><a href="10.2-resampling-methods.html#cb140-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;list&gt;             &lt;chr&gt;     </span></span>
<span id="cb140-6"><a href="10.2-resampling-methods.html#cb140-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 &lt;split [2107/235]&gt; Resample01</span></span>
<span id="cb140-7"><a href="10.2-resampling-methods.html#cb140-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 &lt;split [2107/235]&gt; Resample02</span></span>
<span id="cb140-8"><a href="10.2-resampling-methods.html#cb140-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 &lt;split [2107/235]&gt; Resample03</span></span>
<span id="cb140-9"><a href="10.2-resampling-methods.html#cb140-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 &lt;split [2107/235]&gt; Resample04</span></span>
<span id="cb140-10"><a href="10.2-resampling-methods.html#cb140-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 &lt;split [2107/235]&gt; Resample05</span></span>
<span id="cb140-11"><a href="10.2-resampling-methods.html#cb140-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 &lt;split [2107/235]&gt; Resample06</span></span>
<span id="cb140-12"><a href="10.2-resampling-methods.html#cb140-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # … with 14 more rows</span></span></code></pre></div>
</div>
<div id="validation" class="section level3" number="10.2.2">
<h3><span class="header-section-number">10.2.2</span> Validation sets</h3>
<p>In Chapter <a href="5-splitting.html#splitting">5</a>, we briefly discussed the use of a validation set, a single partition that is set aside to estimate performance separate from the test set. When using a validation set, the initial available data set is split into a training set, a validation set, and a test set (see Figure <a href="10.2-resampling-methods.html#fig:three-way-split">10.5</a>).</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:three-way-split"></span>
<img src="premade/validation.svg" alt="A three-way initial split into training, testing, and validation sets." width="50%" />
<p class="caption">
Figure 10.5: A three-way initial split into training, testing, and validation sets.
</p>
</div>
<p>Validation sets are often used when the original pool of data is very large. In this case, a single large partition may be adequate to characterize model performance without having to do multiple iterations of resampling.</p>
<p>With the <span class="pkg">rsample</span> package, a validation set is like any other resampling object; this type is different only in that it has a single iteration.<a href="#fn24" class="footnote-ref" id="fnref24"><sup>24</sup></a> Figure <a href="10.2-resampling-methods.html#fig:validation-split">10.6</a> shows this scheme.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:validation-split"></span>
<img src="premade/validation-alt.svg" alt="A two-way initial split into training and testing with an additional validation set split on the training set." width="45%" />
<p class="caption">
Figure 10.6: A two-way initial split into training and testing with an additional validation set split on the training set.
</p>
</div>
<p>To create a validation set object that uses 3/4 of the data for model fitting:</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="10.2-resampling-methods.html#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1002</span>)</span>
<span id="cb141-2"><a href="10.2-resampling-methods.html#cb141-2" aria-hidden="true" tabindex="-1"></a>val_set <span class="ot">&lt;-</span> <span class="fu">validation_split</span>(ames_train, <span class="at">prop =</span> <span class="dv">3</span><span class="sc">/</span><span class="dv">4</span>)</span>
<span id="cb141-3"><a href="10.2-resampling-methods.html#cb141-3" aria-hidden="true" tabindex="-1"></a>val_set</span>
<span id="cb141-4"><a href="10.2-resampling-methods.html#cb141-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # Validation Set Split (0.75/0.25)  </span></span>
<span id="cb141-5"><a href="10.2-resampling-methods.html#cb141-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 1 × 2</span></span>
<span id="cb141-6"><a href="10.2-resampling-methods.html#cb141-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   splits             id        </span></span>
<span id="cb141-7"><a href="10.2-resampling-methods.html#cb141-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;list&gt;             &lt;chr&gt;     </span></span>
<span id="cb141-8"><a href="10.2-resampling-methods.html#cb141-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 &lt;split [1756/586]&gt; validation</span></span></code></pre></div>
</div>
<div id="bootstrap" class="section level3" number="10.2.3">
<h3><span class="header-section-number">10.2.3</span> Bootstrapping</h3>
<p>Bootstrap resampling was originally invented as a method for approximating the sampling distribution of statistics whose theoretical properties are intractable <span class="citation">(<a href="#ref-davison1997bootstrap" role="doc-biblioref">Davison and Hinkley 1997</a>)</span>. Using it to estimate model performance is a secondary application of the method.</p>
<p>A bootstrap sample of the training set is a sample that is the same size as the training set but is drawn <em>with replacement</em>. This means that some training set data points are selected multiple times for the analysis set. Each data point has a 63.2% chance of inclusion in the training set at least once. The assessment set contains all of the training set samples that were not selected for the analysis set (on average, with 36.8% of the training set). When bootstrapping, the assessment set is often called the “out-of-bag” sample.</p>
<p>For a training set of 30 samples, a schematic of three bootstrap samples is shown in Figure<a href="10.2-resampling-methods.html#fig:bootstrapping">10.7</a>.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:bootstrapping"></span>
<img src="premade/bootstraps.svg" alt="A diagram of bootstrapping data usage. For each bootstrap resample, the analysis set is the same size as the training set (due to sampling with replacement) and the assessment set consists of samples not in the analysis set." width="80%" />
<p class="caption">
Figure 10.7: Bootstrapping data usage.
</p>
</div>
<p>Note that the sizes of the assessment sets vary.</p>
<p>Using the <span class="pkg">rsample</span> package, we can create such bootstrap resamples:</p>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="10.2-resampling-methods.html#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bootstraps</span>(ames_train, <span class="at">times =</span> <span class="dv">5</span>)</span>
<span id="cb142-2"><a href="10.2-resampling-methods.html#cb142-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # Bootstrap sampling </span></span>
<span id="cb142-3"><a href="10.2-resampling-methods.html#cb142-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 5 × 2</span></span>
<span id="cb142-4"><a href="10.2-resampling-methods.html#cb142-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   splits             id        </span></span>
<span id="cb142-5"><a href="10.2-resampling-methods.html#cb142-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;list&gt;             &lt;chr&gt;     </span></span>
<span id="cb142-6"><a href="10.2-resampling-methods.html#cb142-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 &lt;split [2342/858]&gt; Bootstrap1</span></span>
<span id="cb142-7"><a href="10.2-resampling-methods.html#cb142-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 &lt;split [2342/855]&gt; Bootstrap2</span></span>
<span id="cb142-8"><a href="10.2-resampling-methods.html#cb142-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 &lt;split [2342/852]&gt; Bootstrap3</span></span>
<span id="cb142-9"><a href="10.2-resampling-methods.html#cb142-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 &lt;split [2342/851]&gt; Bootstrap4</span></span>
<span id="cb142-10"><a href="10.2-resampling-methods.html#cb142-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 &lt;split [2342/867]&gt; Bootstrap5</span></span></code></pre></div>
<p>Bootstrap samples produce performance estimates that have very low variance (unlike cross-validation) but have significant pessimistic bias. This means that, if the true accuracy of a model is 90%, the bootstrap would tend to estimate the value to be less than 90%. The amount of bias cannot be empirically determined with sufficient accuracy. Additionally, the amount of bias changes over the scale of the performance metric. For example, the bias is likely to be different when the accuracy is 90% versus when it is 70%.</p>
<p>The bootstrap is also used inside of many models. For example, the random forest model mentioned earlier contained 1,000 individual decision trees. Each tree was the product of a different bootstrap sample of the training set.</p>
</div>
<div id="rolling" class="section level3" number="10.2.4">
<h3><span class="header-section-number">10.2.4</span> Rolling forecasting origin resampling</h3>
<p>When the data have a strong time component, a resampling method should support modeling to estimate seasonal and other temporal trends within the data. A technique that randomly samples values from the training set can disrupt the model’s ability to estimate these patterns.</p>
<p>Rolling forecast origin resampling <span class="citation">(<a href="#ref-hyndman2018forecasting" role="doc-biblioref">Hyndman and Athanasopoulos 2018</a>)</span> provides a method that emulates how time series data is often partitioned in practice, estimating the model with historical data and evaluating it with the most recent data. For this type of resampling, the size of the initial analysis and assessment sets are specified. The first iteration of resampling uses these sizes, starting from the beginning of the series. The second iteration uses the same data sizes but shifts over by a set number of samples.</p>
<p>To illustrate, a training set of fifteen samples was resampled with an analysis size of eight samples and an assessment set size of three. The second iteration discards the first training set sample and both data sets shift forward by one. This configuration results in five resamples, as shown in Figure<a href="10.2-resampling-methods.html#fig:rolling">10.8</a>.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:rolling"></span>
<img src="premade/rolling.svg" alt="The data usage for rolling forecasting origin resampling. For each split, earlier data are used for modeling and a few subsequent instances are used to measure performance." width="65%" />
<p class="caption">
Figure 10.8: Data usage for rolling forecasting origin resampling.
</p>
</div>
<p>There are a few different configurations of this method:</p>
<ul>
<li><p>The analysis set can cumulatively grow (as opposed to remaining the same size). After the first initial analysis set, new samples can accrue without discarding the earlier data.</p></li>
<li><p>The resamples need not increment by one. For example, for large data sets, the incremental block could be a week or month instead of a day.</p></li>
</ul>
<p>For a year’s worth of data, suppose that six sets of 30-day blocks define the analysis set. For assessment sets of 30 days with a 29-day skip, we can use the <span class="pkg">rsample</span> package to specify:</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="10.2-resampling-methods.html#cb143-1" aria-hidden="true" tabindex="-1"></a>time_slices <span class="ot">&lt;-</span> </span>
<span id="cb143-2"><a href="10.2-resampling-methods.html#cb143-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">365</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb143-3"><a href="10.2-resampling-methods.html#cb143-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rolling_origin</span>(<span class="at">initial =</span> <span class="dv">6</span> <span class="sc">*</span> <span class="dv">30</span>, <span class="at">assess =</span> <span class="dv">30</span>, <span class="at">skip =</span> <span class="dv">29</span>, <span class="at">cumulative =</span> <span class="cn">FALSE</span>)</span>
<span id="cb143-4"><a href="10.2-resampling-methods.html#cb143-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-5"><a href="10.2-resampling-methods.html#cb143-5" aria-hidden="true" tabindex="-1"></a>data_range <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb143-6"><a href="10.2-resampling-methods.html#cb143-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(x, <span class="at">first =</span> <span class="fu">min</span>(x), <span class="at">last =</span> <span class="fu">max</span>(x))</span>
<span id="cb143-7"><a href="10.2-resampling-methods.html#cb143-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb143-8"><a href="10.2-resampling-methods.html#cb143-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-9"><a href="10.2-resampling-methods.html#cb143-9" aria-hidden="true" tabindex="-1"></a><span class="fu">map_dfr</span>(time_slices<span class="sc">$</span>splits, <span class="sc">~</span>   <span class="fu">analysis</span>(.x) <span class="sc">%&gt;%</span> <span class="fu">data_range</span>())</span>
<span id="cb143-10"><a href="10.2-resampling-methods.html#cb143-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 2</span></span>
<span id="cb143-11"><a href="10.2-resampling-methods.html#cb143-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   first  last</span></span>
<span id="cb143-12"><a href="10.2-resampling-methods.html#cb143-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;int&gt; &lt;int&gt;</span></span>
<span id="cb143-13"><a href="10.2-resampling-methods.html#cb143-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1     1   180</span></span>
<span id="cb143-14"><a href="10.2-resampling-methods.html#cb143-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2    31   210</span></span>
<span id="cb143-15"><a href="10.2-resampling-methods.html#cb143-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3    61   240</span></span>
<span id="cb143-16"><a href="10.2-resampling-methods.html#cb143-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4    91   270</span></span>
<span id="cb143-17"><a href="10.2-resampling-methods.html#cb143-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5   121   300</span></span>
<span id="cb143-18"><a href="10.2-resampling-methods.html#cb143-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6   151   330</span></span>
<span id="cb143-19"><a href="10.2-resampling-methods.html#cb143-19" aria-hidden="true" tabindex="-1"></a><span class="fu">map_dfr</span>(time_slices<span class="sc">$</span>splits, <span class="sc">~</span> <span class="fu">assessment</span>(.x) <span class="sc">%&gt;%</span> <span class="fu">data_range</span>())</span>
<span id="cb143-20"><a href="10.2-resampling-methods.html#cb143-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 2</span></span>
<span id="cb143-21"><a href="10.2-resampling-methods.html#cb143-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   first  last</span></span>
<span id="cb143-22"><a href="10.2-resampling-methods.html#cb143-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;int&gt; &lt;int&gt;</span></span>
<span id="cb143-23"><a href="10.2-resampling-methods.html#cb143-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1   181   210</span></span>
<span id="cb143-24"><a href="10.2-resampling-methods.html#cb143-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2   211   240</span></span>
<span id="cb143-25"><a href="10.2-resampling-methods.html#cb143-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3   241   270</span></span>
<span id="cb143-26"><a href="10.2-resampling-methods.html#cb143-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4   271   300</span></span>
<span id="cb143-27"><a href="10.2-resampling-methods.html#cb143-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5   301   330</span></span>
<span id="cb143-28"><a href="10.2-resampling-methods.html#cb143-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6   331   360</span></span></code></pre></div>
</div>
</div>
<h3>REFERENCES</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-davison1997bootstrap" class="csl-entry">
Davison, A, and D Hinkley. 1997. <em>Bootstrap Methods and Their Application</em>. Vol. 1. Cambridge university press.
</div>
<div id="ref-hyndman2018forecasting" class="csl-entry">
Hyndman, R, and G Athanasopoulos. 2018. <em>Forecasting: Principles and Practice</em>. OTexts.
</div>
<div id="ref-fes" class="csl-entry">
———. 2020. <em>Feature Engineering and Selection: A Practical Approach for Predictive Models</em>. CRC Press.
</div>
<div id="ref-xu2001monte" class="csl-entry">
Xu, Q, and Y Liang. 2001. <span>“<span>Monte Carlo</span> Cross Validation.”</span> <em>Chemometrics and Intelligent Laboratory Systems</em> 56 (1): 1–11.
</div>
</div>
<div class="footnotes">
<hr />
<ol start="19">
<li id="fn19"><p>See Section 3.4 of <span class="citation">M. Kuhn and Johnson (<a href="#ref-fes" role="doc-biblioref">2020</a>)</span> for a longer description of the results of change <em>V</em>: <a href="https://bookdown.org/max/FES/resampling.html" class="uri">https://bookdown.org/max/FES/resampling.html</a><a href="10.2-resampling-methods.html#fnref19" class="footnote-back">↩︎</a></p></li>
<li id="fn20"><p>To see this for yourself, try executing <code>lobstr::obj_size(ames_folds)</code> and <code>lobstr::obj_size(ames_train)</code>. The size of the resample object is much less than ten times the size of the original data.<a href="10.2-resampling-methods.html#fnref20" class="footnote-back">↩︎</a></p></li>
<li id="fn21"><p>Some resampling methods require multiple <code>id</code> fields.<a href="10.2-resampling-methods.html#fnref21" class="footnote-back">↩︎</a></p></li>
<li id="fn22"><p>For more details, see Section 3.4.6 of <span class="citation">M. Kuhn and Johnson (<a href="#ref-fes" role="doc-biblioref">2020</a>)</span>: <a href="https://bookdown.org/max/FES/resampling.html#resample-var-bias" class="uri">https://bookdown.org/max/FES/resampling.html#resample-var-bias</a><a href="10.2-resampling-methods.html#fnref22" class="footnote-back">↩︎</a></p></li>
<li id="fn23"><p>These are <em>approximate</em> standard errors. As will be discussed in the next chapter, there is a within-replicate correlation that is typical of resampled results. By ignoring this extra component of variation, the simple calculations shown in this plot are overestimates of the reduction in noise in the standard errors.<a href="10.2-resampling-methods.html#fnref23" class="footnote-back">↩︎</a></p></li>
<li id="fn24"><p>In essence, a validation set can be considered a single iteration of Monte Carlo cross-validation.<a href="10.2-resampling-methods.html#fnref24" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
<p style="text-align: center;">
<a href="10.1-resampling-resubstition.html"><button class="btn btn-default">Previous</button></a>
<a href="10.3-resampling-performance.html"><button class="btn btn-default">Next</button></a>
</p>
</div>
</div>


</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});

</script>

</body>
</html>
